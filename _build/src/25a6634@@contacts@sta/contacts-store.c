/* contacts-store.c generated by valac 0.47.2.1-ce69, the Vala compiler
 * generated from contacts-store.vala, do not modify */

/*
 * Copyright (C) 2011 Alexander Larsson <alexl@redhat.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <glib-object.h>
#include <gee.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <folks/folks.h>
#include <glib/gstdio.h>
#include <gio/gio.h>

#define CONTACTS_TYPE_STORE (contacts_store_get_type ())
#define CONTACTS_STORE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_STORE, ContactsStore))
#define CONTACTS_STORE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_STORE, ContactsStoreClass))
#define CONTACTS_IS_STORE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_STORE))
#define CONTACTS_IS_STORE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_STORE))
#define CONTACTS_STORE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_STORE, ContactsStoreClass))

typedef struct _ContactsStore ContactsStore;
typedef struct _ContactsStoreClass ContactsStoreClass;
typedef struct _ContactsStorePrivate ContactsStorePrivate;
enum  {
	CONTACTS_STORE_0_PROPERTY,
	CONTACTS_STORE_AGGREGATOR_PROPERTY,
	CONTACTS_STORE_BACKEND_STORE_PROPERTY,
	CONTACTS_STORE_IS_QUIESCENT_PROPERTY,
	CONTACTS_STORE_IS_PREPARED_PROPERTY,
	CONTACTS_STORE_NUM_PROPERTIES
};
static GParamSpec* contacts_store_properties[CONTACTS_STORE_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_string_free0(var) ((var == NULL) ? NULL : (var = (g_string_free (var, TRUE), NULL)))
typedef struct _Block2Data Block2Data;
typedef struct _ContactsStoreFindContactData ContactsStoreFindContactData;
enum  {
	CONTACTS_STORE_ADDED_SIGNAL,
	CONTACTS_STORE_REMOVED_SIGNAL,
	CONTACTS_STORE_QUIESCENT_SIGNAL,
	CONTACTS_STORE_PREPARED_SIGNAL,
	CONTACTS_STORE_NUM_SIGNALS
};
static guint contacts_store_signals[CONTACTS_STORE_NUM_SIGNALS] = {0};

struct _ContactsStore {
	GObject parent_instance;
	ContactsStorePrivate * priv;
	GeeHashMultiMap* dont_suggest_link;
};

struct _ContactsStoreClass {
	GObjectClass parent_class;
};

struct _ContactsStorePrivate {
	FolksIndividualAggregator* _aggregator;
};

struct _Block2Data {
	int _ref_count_;
	ContactsStore* self;
	GSourceFunc callback;
	gpointer callback_target;
	GDestroyNotify callback_target_destroy_notify;
};

struct _ContactsStoreFindContactData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsStore* self;
	FolksQuery* query;
	FolksIndividual* result;
	gboolean _tmp0_;
	gboolean _tmp1_;
	Block2Data* _data2_;
	gulong signal_id;
	gulong _tmp2_;
	FolksIndividual* matched;
	guint strength;
	GeeIterator* _i_it;
	FolksIndividualAggregator* _tmp3_;
	GeeMap* _tmp4_;
	GeeMap* _tmp5_;
	GeeCollection* _tmp6_;
	GeeCollection* _tmp7_;
	GeeCollection* _tmp8_;
	GeeIterator* _tmp9_;
	GeeIterator* _tmp10_;
	GeeIterator* _tmp11_;
	FolksIndividual* i;
	GeeIterator* _tmp12_;
	gpointer _tmp13_;
	guint this_strength;
	FolksIndividual* _tmp14_;
	FolksIndividual* _tmp15_;
	FolksIndividual* _tmp16_;
};

static gint ContactsStore_private_offset;
static gpointer contacts_store_parent_class = NULL;

GType contacts_store_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsStore, g_object_unref)
static gboolean contacts_store_individual_can_replace_at_split (ContactsStore* self,
                                                         FolksIndividual* new_individual);
static gboolean contacts_store_individual_should_replace_at_join (ContactsStore* self,
                                                           FolksIndividual* old_individual);
static void contacts_store_read_dont_suggest_db (ContactsStore* self);
static void contacts_store_write_dont_suggest_db (ContactsStore* self);
gboolean contacts_store_may_suggest_link (ContactsStore* self,
                                          FolksIndividual* a,
                                          FolksIndividual* b);
void contacts_store_add_no_suggest_link (ContactsStore* self,
                                         FolksIndividual* a,
                                         FolksIndividual* b);
GeeList* contacts_utils_get_personas_for_display (FolksIndividual* individual);
static void contacts_store_on_individuals_changed_detailed (ContactsStore* self,
                                                     GeeMultiMap* changes);
GeeCollection* contacts_store_get_contacts (ContactsStore* self);
FolksIndividualAggregator* contacts_store_get_aggregator (ContactsStore* self);
static void contacts_store_find_contact_data_free (gpointer _data);
void contacts_store_find_contact (ContactsStore* self,
                                  FolksQuery* query,
                                  GAsyncReadyCallback _callback_,
                                  gpointer _user_data_);
FolksIndividual* contacts_store_find_contact_finish (ContactsStore* self,
                                                     GAsyncResult* _res_);
static gboolean contacts_store_find_contact_co (ContactsStoreFindContactData* _data_);
gboolean contacts_store_get_is_quiescent (ContactsStore* self);
static Block2Data* block2_data_ref (Block2Data* _data2_);
static void block2_data_unref (void * _userdata_);
static gboolean _contacts_store_find_contact_co_gsource_func (gpointer self);
static void ___lambda7_ (Block2Data* _data2_);
static void ____lambda7__contacts_store_quiescent (ContactsStore* _sender,
                                            gpointer self);
ContactsStore* contacts_store_new (void);
ContactsStore* contacts_store_construct (GType object_type);
static void contacts_store_set_aggregator (ContactsStore* self,
                                    FolksIndividualAggregator* value);
FolksBackendStore* contacts_store_get_backend_store (ContactsStore* self);
gboolean contacts_store_get_is_prepared (ContactsStore* self);
static GObject * contacts_store_constructor (GType type,
                                      guint n_construct_properties,
                                      GObjectConstructParam * construct_properties);
static void _contacts_store___lambda8_ (ContactsStore* self,
                                 GObject* obj,
                                 GParamSpec* pspec);
static gboolean __lambda9_ (ContactsStore* self);
static gboolean ___lambda9__gsource_func (gpointer self);
static void __contacts_store___lambda8__g_object_notify (GObject* _sender,
                                                  GParamSpec* pspec,
                                                  gpointer self);
static void _contacts_store___lambda10_ (ContactsStore* self,
                                  GObject* obj,
                                  GParamSpec* pspec);
static gboolean __lambda11_ (ContactsStore* self);
static gboolean ___lambda11__gsource_func (gpointer self);
static void __contacts_store___lambda10__g_object_notify (GObject* _sender,
                                                   GParamSpec* pspec,
                                                   gpointer self);
static void _contacts_store_on_individuals_changed_detailed_folks_individual_aggregator_individuals_changed_detailed (FolksIndividualAggregator* _sender,
                                                                                                               GeeMultiMap* changes,
                                                                                                               gpointer self);
static void contacts_store_finalize (GObject * obj);
static GType contacts_store_get_type_once (void);
static void _vala_contacts_store_get_property (GObject * object,
                                        guint property_id,
                                        GValue * value,
                                        GParamSpec * pspec);
static void _vala_contacts_store_set_property (GObject * object,
                                        guint property_id,
                                        const GValue * value,
                                        GParamSpec * pspec);
static void _vala_array_destroy (gpointer array,
                          gint array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gint array_length,
                       GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);

static inline gpointer
contacts_store_get_instance_private (ContactsStore* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsStore_private_offset);
}

static gboolean
contacts_store_individual_can_replace_at_split (ContactsStore* self,
                                                FolksIndividual* new_individual)
{
	gboolean result = FALSE;
#line 45 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 45 "../src/contacts-store.vala"
	g_return_val_if_fail (new_individual != NULL, FALSE);
#line 219 "contacts-store.c"
	{
		GeeIterator* _p_it = NULL;
		GeeSet* _tmp0_;
		GeeSet* _tmp1_;
		GeeIterator* _tmp2_;
#line 46 "../src/contacts-store.vala"
		_tmp0_ = folks_individual_get_personas (new_individual);
#line 46 "../src/contacts-store.vala"
		_tmp1_ = _tmp0_;
#line 46 "../src/contacts-store.vala"
		_tmp2_ = gee_iterable_iterator ((GeeIterable*) _tmp1_);
#line 46 "../src/contacts-store.vala"
		_p_it = _tmp2_;
#line 46 "../src/contacts-store.vala"
		while (TRUE) {
#line 235 "contacts-store.c"
			GeeIterator* _tmp3_;
			FolksPersona* p = NULL;
			GeeIterator* _tmp4_;
			gpointer _tmp5_;
			FolksPersona* _tmp6_;
			gconstpointer _tmp7_;
#line 46 "../src/contacts-store.vala"
			_tmp3_ = _p_it;
#line 46 "../src/contacts-store.vala"
			if (!gee_iterator_next (_tmp3_)) {
#line 46 "../src/contacts-store.vala"
				break;
#line 248 "contacts-store.c"
			}
#line 46 "../src/contacts-store.vala"
			_tmp4_ = _p_it;
#line 46 "../src/contacts-store.vala"
			_tmp5_ = gee_iterator_get (_tmp4_);
#line 46 "../src/contacts-store.vala"
			p = (FolksPersona*) _tmp5_;
#line 47 "../src/contacts-store.vala"
			_tmp6_ = p;
#line 47 "../src/contacts-store.vala"
			_tmp7_ = g_object_get_data ((GObject*) _tmp6_, "contacts-new-contact");
#line 47 "../src/contacts-store.vala"
			if ((gboolean) ((gintptr) _tmp7_)) {
#line 48 "../src/contacts-store.vala"
				result = FALSE;
#line 48 "../src/contacts-store.vala"
				_g_object_unref0 (p);
#line 48 "../src/contacts-store.vala"
				_g_object_unref0 (_p_it);
#line 48 "../src/contacts-store.vala"
				return result;
#line 270 "contacts-store.c"
			}
#line 46 "../src/contacts-store.vala"
			_g_object_unref0 (p);
#line 274 "contacts-store.c"
		}
#line 46 "../src/contacts-store.vala"
		_g_object_unref0 (_p_it);
#line 278 "contacts-store.c"
	}
#line 50 "../src/contacts-store.vala"
	result = TRUE;
#line 50 "../src/contacts-store.vala"
	return result;
#line 284 "contacts-store.c"
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 54 "../src/contacts-store.vala"
	return self ? g_object_ref (self) : NULL;
#line 292 "contacts-store.c"
}

static gboolean
contacts_store_individual_should_replace_at_join (ContactsStore* self,
                                                  FolksIndividual* old_individual)
{
	FolksIndividual* c = NULL;
	FolksIndividual* _tmp0_;
	gconstpointer _tmp1_;
	gboolean result = FALSE;
#line 53 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 53 "../src/contacts-store.vala"
	g_return_val_if_fail (old_individual != NULL, FALSE);
#line 54 "../src/contacts-store.vala"
	_tmp0_ = _g_object_ref0 (old_individual);
#line 54 "../src/contacts-store.vala"
	c = _tmp0_;
#line 55 "../src/contacts-store.vala"
	_tmp1_ = g_object_get_data ((GObject*) c, "contacts-master-at-join");
#line 55 "../src/contacts-store.vala"
	result = (gboolean) ((gintptr) _tmp1_);
#line 55 "../src/contacts-store.vala"
	_g_object_unref0 (c);
#line 55 "../src/contacts-store.vala"
	return result;
#line 319 "contacts-store.c"
}

static void
contacts_store_read_dont_suggest_db (ContactsStore* self)
{
	GeeHashMultiMap* _tmp0_;
	GError* _inner_error0_ = NULL;
#line 58 "../src/contacts-store.vala"
	g_return_if_fail (self != NULL);
#line 59 "../src/contacts-store.vala"
	_tmp0_ = self->dont_suggest_link;
#line 59 "../src/contacts-store.vala"
	gee_multi_map_clear ((GeeMultiMap*) _tmp0_);
#line 333 "contacts-store.c"
	{
		gchar* path = NULL;
		const gchar* _tmp1_;
		gchar* _tmp2_;
		gchar* contents = NULL;
		gboolean _tmp3_ = FALSE;
		gchar* _tmp4_ = NULL;
		gboolean _tmp5_;
#line 61 "../src/contacts-store.vala"
		_tmp1_ = g_get_user_config_dir ();
#line 61 "../src/contacts-store.vala"
		_tmp2_ = g_build_filename (_tmp1_, "gnome-contacts", "dont_suggest.db", NULL);
#line 61 "../src/contacts-store.vala"
		path = _tmp2_;
#line 63 "../src/contacts-store.vala"
		_tmp5_ = g_file_get_contents (path, &_tmp4_, NULL, &_inner_error0_);
#line 63 "../src/contacts-store.vala"
		_g_free0 (contents);
#line 63 "../src/contacts-store.vala"
		contents = _tmp4_;
#line 63 "../src/contacts-store.vala"
		_tmp3_ = _tmp5_;
#line 63 "../src/contacts-store.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 63 "../src/contacts-store.vala"
			_g_free0 (contents);
#line 63 "../src/contacts-store.vala"
			_g_free0 (path);
#line 362 "contacts-store.c"
			goto __catch5_g_error;
		}
#line 63 "../src/contacts-store.vala"
		if (_tmp3_) {
#line 367 "contacts-store.c"
			gchar** rows = NULL;
			gchar** _tmp6_;
			gchar** _tmp7_;
			gint rows_length1;
			gint _rows_size_;
			gchar** _tmp8_;
			gint _tmp8__length1;
#line 64 "../src/contacts-store.vala"
			_tmp7_ = _tmp6_ = g_strsplit (contents, "\n", 0);
#line 64 "../src/contacts-store.vala"
			rows = _tmp7_;
#line 64 "../src/contacts-store.vala"
			rows_length1 = _vala_array_length (_tmp6_);
#line 64 "../src/contacts-store.vala"
			_rows_size_ = rows_length1;
#line 65 "../src/contacts-store.vala"
			_tmp8_ = rows;
#line 65 "../src/contacts-store.vala"
			_tmp8__length1 = rows_length1;
#line 387 "contacts-store.c"
			{
				gchar** r_collection = NULL;
				gint r_collection_length1 = 0;
				gint _r_collection_size_ = 0;
				gint r_it = 0;
#line 65 "../src/contacts-store.vala"
				r_collection = _tmp8_;
#line 65 "../src/contacts-store.vala"
				r_collection_length1 = _tmp8__length1;
#line 65 "../src/contacts-store.vala"
				for (r_it = 0; r_it < r_collection_length1; r_it = r_it + 1) {
#line 399 "contacts-store.c"
					gchar* _tmp9_;
					gchar* r = NULL;
#line 65 "../src/contacts-store.vala"
					_tmp9_ = g_strdup (r_collection[r_it]);
#line 65 "../src/contacts-store.vala"
					r = _tmp9_;
#line 406 "contacts-store.c"
					{
						gchar** ids = NULL;
						const gchar* _tmp10_;
						gchar** _tmp11_;
						gchar** _tmp12_;
						gint ids_length1;
						gint _ids_size_;
						gchar** _tmp13_;
						gint _tmp13__length1;
#line 66 "../src/contacts-store.vala"
						_tmp10_ = r;
#line 66 "../src/contacts-store.vala"
						_tmp12_ = _tmp11_ = g_strsplit (_tmp10_, " ", 0);
#line 66 "../src/contacts-store.vala"
						ids = _tmp12_;
#line 66 "../src/contacts-store.vala"
						ids_length1 = _vala_array_length (_tmp11_);
#line 66 "../src/contacts-store.vala"
						_ids_size_ = ids_length1;
#line 67 "../src/contacts-store.vala"
						_tmp13_ = ids;
#line 67 "../src/contacts-store.vala"
						_tmp13__length1 = ids_length1;
#line 67 "../src/contacts-store.vala"
						if (_tmp13__length1 == 2) {
#line 432 "contacts-store.c"
							GeeHashMultiMap* _tmp14_;
							gchar** _tmp15_;
							gint _tmp15__length1;
							const gchar* _tmp16_;
							gchar** _tmp17_;
							gint _tmp17__length1;
							const gchar* _tmp18_;
#line 68 "../src/contacts-store.vala"
							_tmp14_ = self->dont_suggest_link;
#line 68 "../src/contacts-store.vala"
							_tmp15_ = ids;
#line 68 "../src/contacts-store.vala"
							_tmp15__length1 = ids_length1;
#line 68 "../src/contacts-store.vala"
							_tmp16_ = _tmp15_[0];
#line 68 "../src/contacts-store.vala"
							_tmp17_ = ids;
#line 68 "../src/contacts-store.vala"
							_tmp17__length1 = ids_length1;
#line 68 "../src/contacts-store.vala"
							_tmp18_ = _tmp17_[1];
#line 68 "../src/contacts-store.vala"
							gee_multi_map_set ((GeeMultiMap*) _tmp14_, _tmp16_, _tmp18_);
#line 456 "contacts-store.c"
						}
#line 65 "../src/contacts-store.vala"
						ids = (_vala_array_free (ids, ids_length1, (GDestroyNotify) g_free), NULL);
#line 65 "../src/contacts-store.vala"
						_g_free0 (r);
#line 462 "contacts-store.c"
					}
				}
			}
#line 63 "../src/contacts-store.vala"
			rows = (_vala_array_free (rows, rows_length1, (GDestroyNotify) g_free), NULL);
#line 468 "contacts-store.c"
		}
#line 60 "../src/contacts-store.vala"
		_g_free0 (contents);
#line 60 "../src/contacts-store.vala"
		_g_free0 (path);
#line 474 "contacts-store.c"
	}
	goto __finally5;
	__catch5_g_error:
	{
		GError* e = NULL;
		GError* _tmp19_;
#line 60 "../src/contacts-store.vala"
		e = _inner_error0_;
#line 60 "../src/contacts-store.vala"
		_inner_error0_ = NULL;
#line 73 "../src/contacts-store.vala"
		_tmp19_ = e;
#line 73 "../src/contacts-store.vala"
		if (!g_error_matches (_tmp19_, G_FILE_ERROR, G_FILE_ERROR_NOENT)) {
#line 489 "contacts-store.c"
			GError* _tmp20_;
			const gchar* _tmp21_;
#line 74 "../src/contacts-store.vala"
			_tmp20_ = e;
#line 74 "../src/contacts-store.vala"
			_tmp21_ = _tmp20_->message;
#line 74 "../src/contacts-store.vala"
			g_warning ("contacts-store.vala:74: error loading no suggestion db: %s\n", _tmp21_);
#line 498 "contacts-store.c"
		}
#line 60 "../src/contacts-store.vala"
		_g_error_free0 (e);
#line 502 "contacts-store.c"
	}
	__finally5:
#line 60 "../src/contacts-store.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 60 "../src/contacts-store.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 60 "../src/contacts-store.vala"
		g_clear_error (&_inner_error0_);
#line 60 "../src/contacts-store.vala"
		return;
#line 513 "contacts-store.c"
	}
}

static void
contacts_store_write_dont_suggest_db (ContactsStore* self)
{
	GError* _inner_error0_ = NULL;
#line 78 "../src/contacts-store.vala"
	g_return_if_fail (self != NULL);
#line 523 "contacts-store.c"
	{
		gchar* dir = NULL;
		const gchar* _tmp0_;
		gchar* _tmp1_;
		const gchar* _tmp2_;
		gchar* path = NULL;
		const gchar* _tmp3_;
		gchar* _tmp4_;
		GString* s = NULL;
		GString* _tmp5_;
		const gchar* _tmp26_;
		GString* _tmp27_;
		const gchar* _tmp28_;
		GString* _tmp29_;
#line 80 "../src/contacts-store.vala"
		_tmp0_ = g_get_user_config_dir ();
#line 80 "../src/contacts-store.vala"
		_tmp1_ = g_build_filename (_tmp0_, "gnome-contacts", NULL);
#line 80 "../src/contacts-store.vala"
		dir = _tmp1_;
#line 81 "../src/contacts-store.vala"
		_tmp2_ = dir;
#line 81 "../src/contacts-store.vala"
		g_mkdir_with_parents (_tmp2_, 0700);
#line 82 "../src/contacts-store.vala"
		_tmp3_ = dir;
#line 82 "../src/contacts-store.vala"
		_tmp4_ = g_build_filename (_tmp3_, "dont_suggest.db", NULL);
#line 82 "../src/contacts-store.vala"
		path = _tmp4_;
#line 84 "../src/contacts-store.vala"
		_tmp5_ = g_string_new ("");
#line 84 "../src/contacts-store.vala"
		s = _tmp5_;
#line 558 "contacts-store.c"
		{
			GeeIterator* _key_it = NULL;
			GeeHashMultiMap* _tmp6_;
			GeeSet* _tmp7_;
			GeeSet* _tmp8_;
			GeeIterator* _tmp9_;
			GeeIterator* _tmp10_;
#line 85 "../src/contacts-store.vala"
			_tmp6_ = self->dont_suggest_link;
#line 85 "../src/contacts-store.vala"
			_tmp7_ = gee_multi_map_get_keys ((GeeMultiMap*) _tmp6_);
#line 85 "../src/contacts-store.vala"
			_tmp8_ = _tmp7_;
#line 85 "../src/contacts-store.vala"
			_tmp9_ = gee_iterable_iterator ((GeeIterable*) _tmp8_);
#line 85 "../src/contacts-store.vala"
			_tmp10_ = _tmp9_;
#line 85 "../src/contacts-store.vala"
			_g_object_unref0 (_tmp8_);
#line 85 "../src/contacts-store.vala"
			_key_it = _tmp10_;
#line 85 "../src/contacts-store.vala"
			while (TRUE) {
#line 582 "contacts-store.c"
				GeeIterator* _tmp11_;
				gchar* key = NULL;
				GeeIterator* _tmp12_;
				gpointer _tmp13_;
#line 85 "../src/contacts-store.vala"
				_tmp11_ = _key_it;
#line 85 "../src/contacts-store.vala"
				if (!gee_iterator_next (_tmp11_)) {
#line 85 "../src/contacts-store.vala"
					break;
#line 593 "contacts-store.c"
				}
#line 85 "../src/contacts-store.vala"
				_tmp12_ = _key_it;
#line 85 "../src/contacts-store.vala"
				_tmp13_ = gee_iterator_get (_tmp12_);
#line 85 "../src/contacts-store.vala"
				key = (gchar*) _tmp13_;
#line 601 "contacts-store.c"
				{
					GeeIterator* _value_it = NULL;
					GeeHashMultiMap* _tmp14_;
					const gchar* _tmp15_;
					GeeCollection* _tmp16_;
					GeeCollection* _tmp17_;
					GeeIterator* _tmp18_;
					GeeIterator* _tmp19_;
#line 86 "../src/contacts-store.vala"
					_tmp14_ = self->dont_suggest_link;
#line 86 "../src/contacts-store.vala"
					_tmp15_ = key;
#line 86 "../src/contacts-store.vala"
					_tmp16_ = gee_multi_map_get ((GeeMultiMap*) _tmp14_, _tmp15_);
#line 86 "../src/contacts-store.vala"
					_tmp17_ = _tmp16_;
#line 86 "../src/contacts-store.vala"
					_tmp18_ = gee_iterable_iterator ((GeeIterable*) _tmp17_);
#line 86 "../src/contacts-store.vala"
					_tmp19_ = _tmp18_;
#line 86 "../src/contacts-store.vala"
					_g_object_unref0 (_tmp17_);
#line 86 "../src/contacts-store.vala"
					_value_it = _tmp19_;
#line 86 "../src/contacts-store.vala"
					while (TRUE) {
#line 628 "contacts-store.c"
						GeeIterator* _tmp20_;
						gchar* value = NULL;
						GeeIterator* _tmp21_;
						gpointer _tmp22_;
						GString* _tmp23_;
						const gchar* _tmp24_;
						const gchar* _tmp25_;
#line 86 "../src/contacts-store.vala"
						_tmp20_ = _value_it;
#line 86 "../src/contacts-store.vala"
						if (!gee_iterator_next (_tmp20_)) {
#line 86 "../src/contacts-store.vala"
							break;
#line 642 "contacts-store.c"
						}
#line 86 "../src/contacts-store.vala"
						_tmp21_ = _value_it;
#line 86 "../src/contacts-store.vala"
						_tmp22_ = gee_iterator_get (_tmp21_);
#line 86 "../src/contacts-store.vala"
						value = (gchar*) _tmp22_;
#line 87 "../src/contacts-store.vala"
						_tmp23_ = s;
#line 87 "../src/contacts-store.vala"
						_tmp24_ = key;
#line 87 "../src/contacts-store.vala"
						_tmp25_ = value;
#line 87 "../src/contacts-store.vala"
						g_string_append_printf (_tmp23_, "%s %s\n", _tmp24_, _tmp25_);
#line 86 "../src/contacts-store.vala"
						_g_free0 (value);
#line 660 "contacts-store.c"
					}
#line 86 "../src/contacts-store.vala"
					_g_object_unref0 (_value_it);
#line 664 "contacts-store.c"
				}
#line 85 "../src/contacts-store.vala"
				_g_free0 (key);
#line 668 "contacts-store.c"
			}
#line 85 "../src/contacts-store.vala"
			_g_object_unref0 (_key_it);
#line 672 "contacts-store.c"
		}
#line 90 "../src/contacts-store.vala"
		_tmp26_ = path;
#line 90 "../src/contacts-store.vala"
		_tmp27_ = s;
#line 90 "../src/contacts-store.vala"
		_tmp28_ = _tmp27_->str;
#line 90 "../src/contacts-store.vala"
		_tmp29_ = s;
#line 90 "../src/contacts-store.vala"
		g_file_set_contents (_tmp26_, _tmp28_, _tmp29_->len, &_inner_error0_);
#line 90 "../src/contacts-store.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 90 "../src/contacts-store.vala"
			_g_string_free0 (s);
#line 90 "../src/contacts-store.vala"
			_g_free0 (path);
#line 90 "../src/contacts-store.vala"
			_g_free0 (dir);
#line 692 "contacts-store.c"
			goto __catch6_g_error;
		}
#line 79 "../src/contacts-store.vala"
		_g_string_free0 (s);
#line 79 "../src/contacts-store.vala"
		_g_free0 (path);
#line 79 "../src/contacts-store.vala"
		_g_free0 (dir);
#line 701 "contacts-store.c"
	}
	goto __finally6;
	__catch6_g_error:
	{
		GError* e = NULL;
		GError* _tmp30_;
		const gchar* _tmp31_;
#line 79 "../src/contacts-store.vala"
		e = _inner_error0_;
#line 79 "../src/contacts-store.vala"
		_inner_error0_ = NULL;
#line 92 "../src/contacts-store.vala"
		_tmp30_ = e;
#line 92 "../src/contacts-store.vala"
		_tmp31_ = _tmp30_->message;
#line 92 "../src/contacts-store.vala"
		g_warning ("contacts-store.vala:92: error writing no suggestion db: %s\n", _tmp31_);
#line 79 "../src/contacts-store.vala"
		_g_error_free0 (e);
#line 721 "contacts-store.c"
	}
	__finally6:
#line 79 "../src/contacts-store.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 79 "../src/contacts-store.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 79 "../src/contacts-store.vala"
		g_clear_error (&_inner_error0_);
#line 79 "../src/contacts-store.vala"
		return;
#line 732 "contacts-store.c"
	}
}

gboolean
contacts_store_may_suggest_link (ContactsStore* self,
                                 FolksIndividual* a,
                                 FolksIndividual* b)
{
	gboolean result = FALSE;
#line 96 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 96 "../src/contacts-store.vala"
	g_return_val_if_fail (a != NULL, FALSE);
#line 96 "../src/contacts-store.vala"
	g_return_val_if_fail (b != NULL, FALSE);
#line 748 "contacts-store.c"
	{
		GeeIterator* _a_persona_it = NULL;
		GeeSet* _tmp0_;
		GeeSet* _tmp1_;
		GeeIterator* _tmp2_;
#line 97 "../src/contacts-store.vala"
		_tmp0_ = folks_individual_get_personas (a);
#line 97 "../src/contacts-store.vala"
		_tmp1_ = _tmp0_;
#line 97 "../src/contacts-store.vala"
		_tmp2_ = gee_iterable_iterator ((GeeIterable*) _tmp1_);
#line 97 "../src/contacts-store.vala"
		_a_persona_it = _tmp2_;
#line 97 "../src/contacts-store.vala"
		while (TRUE) {
#line 764 "contacts-store.c"
			GeeIterator* _tmp3_;
			FolksPersona* a_persona = NULL;
			GeeIterator* _tmp4_;
			gpointer _tmp5_;
#line 97 "../src/contacts-store.vala"
			_tmp3_ = _a_persona_it;
#line 97 "../src/contacts-store.vala"
			if (!gee_iterator_next (_tmp3_)) {
#line 97 "../src/contacts-store.vala"
				break;
#line 775 "contacts-store.c"
			}
#line 97 "../src/contacts-store.vala"
			_tmp4_ = _a_persona_it;
#line 97 "../src/contacts-store.vala"
			_tmp5_ = gee_iterator_get (_tmp4_);
#line 97 "../src/contacts-store.vala"
			a_persona = (FolksPersona*) _tmp5_;
#line 783 "contacts-store.c"
			{
				GeeIterator* _no_link_uid_it = NULL;
				GeeHashMultiMap* _tmp6_;
				FolksPersona* _tmp7_;
				const gchar* _tmp8_;
				const gchar* _tmp9_;
				GeeCollection* _tmp10_;
				GeeCollection* _tmp11_;
				GeeIterator* _tmp12_;
				GeeIterator* _tmp13_;
#line 98 "../src/contacts-store.vala"
				_tmp6_ = self->dont_suggest_link;
#line 98 "../src/contacts-store.vala"
				_tmp7_ = a_persona;
#line 98 "../src/contacts-store.vala"
				_tmp8_ = folks_persona_get_uid (_tmp7_);
#line 98 "../src/contacts-store.vala"
				_tmp9_ = _tmp8_;
#line 98 "../src/contacts-store.vala"
				_tmp10_ = gee_multi_map_get ((GeeMultiMap*) _tmp6_, _tmp9_);
#line 98 "../src/contacts-store.vala"
				_tmp11_ = _tmp10_;
#line 98 "../src/contacts-store.vala"
				_tmp12_ = gee_iterable_iterator ((GeeIterable*) _tmp11_);
#line 98 "../src/contacts-store.vala"
				_tmp13_ = _tmp12_;
#line 98 "../src/contacts-store.vala"
				_g_object_unref0 (_tmp11_);
#line 98 "../src/contacts-store.vala"
				_no_link_uid_it = _tmp13_;
#line 98 "../src/contacts-store.vala"
				while (TRUE) {
#line 816 "contacts-store.c"
					GeeIterator* _tmp14_;
					gchar* no_link_uid = NULL;
					GeeIterator* _tmp15_;
					gpointer _tmp16_;
#line 98 "../src/contacts-store.vala"
					_tmp14_ = _no_link_uid_it;
#line 98 "../src/contacts-store.vala"
					if (!gee_iterator_next (_tmp14_)) {
#line 98 "../src/contacts-store.vala"
						break;
#line 827 "contacts-store.c"
					}
#line 98 "../src/contacts-store.vala"
					_tmp15_ = _no_link_uid_it;
#line 98 "../src/contacts-store.vala"
					_tmp16_ = gee_iterator_get (_tmp15_);
#line 98 "../src/contacts-store.vala"
					no_link_uid = (gchar*) _tmp16_;
#line 835 "contacts-store.c"
					{
						GeeIterator* _b_persona_it = NULL;
						GeeSet* _tmp17_;
						GeeSet* _tmp18_;
						GeeIterator* _tmp19_;
#line 99 "../src/contacts-store.vala"
						_tmp17_ = folks_individual_get_personas (b);
#line 99 "../src/contacts-store.vala"
						_tmp18_ = _tmp17_;
#line 99 "../src/contacts-store.vala"
						_tmp19_ = gee_iterable_iterator ((GeeIterable*) _tmp18_);
#line 99 "../src/contacts-store.vala"
						_b_persona_it = _tmp19_;
#line 99 "../src/contacts-store.vala"
						while (TRUE) {
#line 851 "contacts-store.c"
							GeeIterator* _tmp20_;
							FolksPersona* b_persona = NULL;
							GeeIterator* _tmp21_;
							gpointer _tmp22_;
							FolksPersona* _tmp23_;
							const gchar* _tmp24_;
							const gchar* _tmp25_;
							const gchar* _tmp26_;
#line 99 "../src/contacts-store.vala"
							_tmp20_ = _b_persona_it;
#line 99 "../src/contacts-store.vala"
							if (!gee_iterator_next (_tmp20_)) {
#line 99 "../src/contacts-store.vala"
								break;
#line 866 "contacts-store.c"
							}
#line 99 "../src/contacts-store.vala"
							_tmp21_ = _b_persona_it;
#line 99 "../src/contacts-store.vala"
							_tmp22_ = gee_iterator_get (_tmp21_);
#line 99 "../src/contacts-store.vala"
							b_persona = (FolksPersona*) _tmp22_;
#line 100 "../src/contacts-store.vala"
							_tmp23_ = b_persona;
#line 100 "../src/contacts-store.vala"
							_tmp24_ = folks_persona_get_uid (_tmp23_);
#line 100 "../src/contacts-store.vala"
							_tmp25_ = _tmp24_;
#line 100 "../src/contacts-store.vala"
							_tmp26_ = no_link_uid;
#line 100 "../src/contacts-store.vala"
							if (g_strcmp0 (_tmp25_, _tmp26_) == 0) {
#line 101 "../src/contacts-store.vala"
								result = FALSE;
#line 101 "../src/contacts-store.vala"
								_g_object_unref0 (b_persona);
#line 101 "../src/contacts-store.vala"
								_g_object_unref0 (_b_persona_it);
#line 101 "../src/contacts-store.vala"
								_g_free0 (no_link_uid);
#line 101 "../src/contacts-store.vala"
								_g_object_unref0 (_no_link_uid_it);
#line 101 "../src/contacts-store.vala"
								_g_object_unref0 (a_persona);
#line 101 "../src/contacts-store.vala"
								_g_object_unref0 (_a_persona_it);
#line 101 "../src/contacts-store.vala"
								return result;
#line 900 "contacts-store.c"
							}
#line 99 "../src/contacts-store.vala"
							_g_object_unref0 (b_persona);
#line 904 "contacts-store.c"
						}
#line 99 "../src/contacts-store.vala"
						_g_object_unref0 (_b_persona_it);
#line 908 "contacts-store.c"
					}
#line 98 "../src/contacts-store.vala"
					_g_free0 (no_link_uid);
#line 912 "contacts-store.c"
				}
#line 98 "../src/contacts-store.vala"
				_g_object_unref0 (_no_link_uid_it);
#line 916 "contacts-store.c"
			}
#line 97 "../src/contacts-store.vala"
			_g_object_unref0 (a_persona);
#line 920 "contacts-store.c"
		}
#line 97 "../src/contacts-store.vala"
		_g_object_unref0 (_a_persona_it);
#line 924 "contacts-store.c"
	}
	{
		GeeIterator* _b_persona_it = NULL;
		GeeSet* _tmp27_;
		GeeSet* _tmp28_;
		GeeIterator* _tmp29_;
#line 105 "../src/contacts-store.vala"
		_tmp27_ = folks_individual_get_personas (b);
#line 105 "../src/contacts-store.vala"
		_tmp28_ = _tmp27_;
#line 105 "../src/contacts-store.vala"
		_tmp29_ = gee_iterable_iterator ((GeeIterable*) _tmp28_);
#line 105 "../src/contacts-store.vala"
		_b_persona_it = _tmp29_;
#line 105 "../src/contacts-store.vala"
		while (TRUE) {
#line 941 "contacts-store.c"
			GeeIterator* _tmp30_;
			FolksPersona* b_persona = NULL;
			GeeIterator* _tmp31_;
			gpointer _tmp32_;
#line 105 "../src/contacts-store.vala"
			_tmp30_ = _b_persona_it;
#line 105 "../src/contacts-store.vala"
			if (!gee_iterator_next (_tmp30_)) {
#line 105 "../src/contacts-store.vala"
				break;
#line 952 "contacts-store.c"
			}
#line 105 "../src/contacts-store.vala"
			_tmp31_ = _b_persona_it;
#line 105 "../src/contacts-store.vala"
			_tmp32_ = gee_iterator_get (_tmp31_);
#line 105 "../src/contacts-store.vala"
			b_persona = (FolksPersona*) _tmp32_;
#line 960 "contacts-store.c"
			{
				GeeIterator* _no_link_uid_it = NULL;
				GeeHashMultiMap* _tmp33_;
				FolksPersona* _tmp34_;
				const gchar* _tmp35_;
				const gchar* _tmp36_;
				GeeCollection* _tmp37_;
				GeeCollection* _tmp38_;
				GeeIterator* _tmp39_;
				GeeIterator* _tmp40_;
#line 106 "../src/contacts-store.vala"
				_tmp33_ = self->dont_suggest_link;
#line 106 "../src/contacts-store.vala"
				_tmp34_ = b_persona;
#line 106 "../src/contacts-store.vala"
				_tmp35_ = folks_persona_get_uid (_tmp34_);
#line 106 "../src/contacts-store.vala"
				_tmp36_ = _tmp35_;
#line 106 "../src/contacts-store.vala"
				_tmp37_ = gee_multi_map_get ((GeeMultiMap*) _tmp33_, _tmp36_);
#line 106 "../src/contacts-store.vala"
				_tmp38_ = _tmp37_;
#line 106 "../src/contacts-store.vala"
				_tmp39_ = gee_iterable_iterator ((GeeIterable*) _tmp38_);
#line 106 "../src/contacts-store.vala"
				_tmp40_ = _tmp39_;
#line 106 "../src/contacts-store.vala"
				_g_object_unref0 (_tmp38_);
#line 106 "../src/contacts-store.vala"
				_no_link_uid_it = _tmp40_;
#line 106 "../src/contacts-store.vala"
				while (TRUE) {
#line 993 "contacts-store.c"
					GeeIterator* _tmp41_;
					gchar* no_link_uid = NULL;
					GeeIterator* _tmp42_;
					gpointer _tmp43_;
#line 106 "../src/contacts-store.vala"
					_tmp41_ = _no_link_uid_it;
#line 106 "../src/contacts-store.vala"
					if (!gee_iterator_next (_tmp41_)) {
#line 106 "../src/contacts-store.vala"
						break;
#line 1004 "contacts-store.c"
					}
#line 106 "../src/contacts-store.vala"
					_tmp42_ = _no_link_uid_it;
#line 106 "../src/contacts-store.vala"
					_tmp43_ = gee_iterator_get (_tmp42_);
#line 106 "../src/contacts-store.vala"
					no_link_uid = (gchar*) _tmp43_;
#line 1012 "contacts-store.c"
					{
						GeeIterator* _a_persona_it = NULL;
						GeeSet* _tmp44_;
						GeeSet* _tmp45_;
						GeeIterator* _tmp46_;
#line 107 "../src/contacts-store.vala"
						_tmp44_ = folks_individual_get_personas (a);
#line 107 "../src/contacts-store.vala"
						_tmp45_ = _tmp44_;
#line 107 "../src/contacts-store.vala"
						_tmp46_ = gee_iterable_iterator ((GeeIterable*) _tmp45_);
#line 107 "../src/contacts-store.vala"
						_a_persona_it = _tmp46_;
#line 107 "../src/contacts-store.vala"
						while (TRUE) {
#line 1028 "contacts-store.c"
							GeeIterator* _tmp47_;
							FolksPersona* a_persona = NULL;
							GeeIterator* _tmp48_;
							gpointer _tmp49_;
							FolksPersona* _tmp50_;
							const gchar* _tmp51_;
							const gchar* _tmp52_;
							const gchar* _tmp53_;
#line 107 "../src/contacts-store.vala"
							_tmp47_ = _a_persona_it;
#line 107 "../src/contacts-store.vala"
							if (!gee_iterator_next (_tmp47_)) {
#line 107 "../src/contacts-store.vala"
								break;
#line 1043 "contacts-store.c"
							}
#line 107 "../src/contacts-store.vala"
							_tmp48_ = _a_persona_it;
#line 107 "../src/contacts-store.vala"
							_tmp49_ = gee_iterator_get (_tmp48_);
#line 107 "../src/contacts-store.vala"
							a_persona = (FolksPersona*) _tmp49_;
#line 108 "../src/contacts-store.vala"
							_tmp50_ = a_persona;
#line 108 "../src/contacts-store.vala"
							_tmp51_ = folks_persona_get_uid (_tmp50_);
#line 108 "../src/contacts-store.vala"
							_tmp52_ = _tmp51_;
#line 108 "../src/contacts-store.vala"
							_tmp53_ = no_link_uid;
#line 108 "../src/contacts-store.vala"
							if (g_strcmp0 (_tmp52_, _tmp53_) == 0) {
#line 109 "../src/contacts-store.vala"
								result = FALSE;
#line 109 "../src/contacts-store.vala"
								_g_object_unref0 (a_persona);
#line 109 "../src/contacts-store.vala"
								_g_object_unref0 (_a_persona_it);
#line 109 "../src/contacts-store.vala"
								_g_free0 (no_link_uid);
#line 109 "../src/contacts-store.vala"
								_g_object_unref0 (_no_link_uid_it);
#line 109 "../src/contacts-store.vala"
								_g_object_unref0 (b_persona);
#line 109 "../src/contacts-store.vala"
								_g_object_unref0 (_b_persona_it);
#line 109 "../src/contacts-store.vala"
								return result;
#line 1077 "contacts-store.c"
							}
#line 107 "../src/contacts-store.vala"
							_g_object_unref0 (a_persona);
#line 1081 "contacts-store.c"
						}
#line 107 "../src/contacts-store.vala"
						_g_object_unref0 (_a_persona_it);
#line 1085 "contacts-store.c"
					}
#line 106 "../src/contacts-store.vala"
					_g_free0 (no_link_uid);
#line 1089 "contacts-store.c"
				}
#line 106 "../src/contacts-store.vala"
				_g_object_unref0 (_no_link_uid_it);
#line 1093 "contacts-store.c"
			}
#line 105 "../src/contacts-store.vala"
			_g_object_unref0 (b_persona);
#line 1097 "contacts-store.c"
		}
#line 105 "../src/contacts-store.vala"
		_g_object_unref0 (_b_persona_it);
#line 1101 "contacts-store.c"
	}
#line 113 "../src/contacts-store.vala"
	result = TRUE;
#line 113 "../src/contacts-store.vala"
	return result;
#line 1107 "contacts-store.c"
}

void
contacts_store_add_no_suggest_link (ContactsStore* self,
                                    FolksIndividual* a,
                                    FolksIndividual* b)
{
	FolksPersona* persona1 = NULL;
	GeeList* _tmp0_;
	GeeList* _tmp1_;
	gint _tmp2_ = 0;
	gpointer* _tmp3_;
	FolksPersona** _tmp4_;
	gint _tmp4__length1;
	FolksPersona* _tmp5_;
	FolksPersona* _tmp6_;
	FolksPersona* _tmp7_;
	FolksPersona* persona2 = NULL;
	GeeList* _tmp8_;
	GeeList* _tmp9_;
	gint _tmp10_ = 0;
	gpointer* _tmp11_;
	FolksPersona** _tmp12_;
	gint _tmp12__length1;
	FolksPersona* _tmp13_;
	FolksPersona* _tmp14_;
	FolksPersona* _tmp15_;
	GeeHashMultiMap* _tmp16_;
	const gchar* _tmp17_;
	const gchar* _tmp18_;
	const gchar* _tmp19_;
	const gchar* _tmp20_;
#line 116 "../src/contacts-store.vala"
	g_return_if_fail (self != NULL);
#line 116 "../src/contacts-store.vala"
	g_return_if_fail (a != NULL);
#line 116 "../src/contacts-store.vala"
	g_return_if_fail (b != NULL);
#line 117 "../src/contacts-store.vala"
	_tmp0_ = contacts_utils_get_personas_for_display (a);
#line 117 "../src/contacts-store.vala"
	_tmp1_ = _tmp0_;
#line 117 "../src/contacts-store.vala"
	_tmp3_ = gee_collection_to_array ((GeeCollection*) _tmp1_, &_tmp2_);
#line 117 "../src/contacts-store.vala"
	_tmp4_ = _tmp3_;
#line 117 "../src/contacts-store.vala"
	_tmp4__length1 = _tmp2_;
#line 117 "../src/contacts-store.vala"
	_tmp5_ = _tmp4_[0];
#line 117 "../src/contacts-store.vala"
	_tmp6_ = _g_object_ref0 (_tmp5_);
#line 117 "../src/contacts-store.vala"
	_tmp7_ = _tmp6_;
#line 117 "../src/contacts-store.vala"
	_tmp4_ = (_vala_array_free (_tmp4_, _tmp4__length1, (GDestroyNotify) g_object_unref), NULL);
#line 117 "../src/contacts-store.vala"
	_g_object_unref0 (_tmp1_);
#line 117 "../src/contacts-store.vala"
	persona1 = _tmp7_;
#line 118 "../src/contacts-store.vala"
	_tmp8_ = contacts_utils_get_personas_for_display (b);
#line 118 "../src/contacts-store.vala"
	_tmp9_ = _tmp8_;
#line 118 "../src/contacts-store.vala"
	_tmp11_ = gee_collection_to_array ((GeeCollection*) _tmp9_, &_tmp10_);
#line 118 "../src/contacts-store.vala"
	_tmp12_ = _tmp11_;
#line 118 "../src/contacts-store.vala"
	_tmp12__length1 = _tmp10_;
#line 118 "../src/contacts-store.vala"
	_tmp13_ = _tmp12_[0];
#line 118 "../src/contacts-store.vala"
	_tmp14_ = _g_object_ref0 (_tmp13_);
#line 118 "../src/contacts-store.vala"
	_tmp15_ = _tmp14_;
#line 118 "../src/contacts-store.vala"
	_tmp12_ = (_vala_array_free (_tmp12_, _tmp12__length1, (GDestroyNotify) g_object_unref), NULL);
#line 118 "../src/contacts-store.vala"
	_g_object_unref0 (_tmp9_);
#line 118 "../src/contacts-store.vala"
	persona2 = _tmp15_;
#line 119 "../src/contacts-store.vala"
	_tmp16_ = self->dont_suggest_link;
#line 119 "../src/contacts-store.vala"
	_tmp17_ = folks_persona_get_uid (persona1);
#line 119 "../src/contacts-store.vala"
	_tmp18_ = _tmp17_;
#line 119 "../src/contacts-store.vala"
	_tmp19_ = folks_persona_get_uid (persona2);
#line 119 "../src/contacts-store.vala"
	_tmp20_ = _tmp19_;
#line 119 "../src/contacts-store.vala"
	gee_multi_map_set ((GeeMultiMap*) _tmp16_, _tmp18_, _tmp20_);
#line 120 "../src/contacts-store.vala"
	contacts_store_write_dont_suggest_db (self);
#line 116 "../src/contacts-store.vala"
	_g_object_unref0 (persona2);
#line 116 "../src/contacts-store.vala"
	_g_object_unref0 (persona1);
#line 1208 "contacts-store.c"
}

static void
contacts_store_on_individuals_changed_detailed (ContactsStore* self,
                                                GeeMultiMap* changes)
{
	GeeHashMap* replaced_individuals = NULL;
	GeeHashMap* _tmp0_;
	GeeSet* old_individuals = NULL;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	gint _tmp3_;
	gint _tmp4_;
	GeeCollection* _tmp5_;
	GeeCollection* _tmp6_;
	gint _tmp7_;
	gint _tmp8_;
#line 153 "../src/contacts-store.vala"
	g_return_if_fail (self != NULL);
#line 153 "../src/contacts-store.vala"
	g_return_if_fail (changes != NULL);
#line 156 "../src/contacts-store.vala"
	_tmp0_ = gee_hash_map_new (FOLKS_TYPE_INDIVIDUAL, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, FOLKS_TYPE_INDIVIDUAL, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 156 "../src/contacts-store.vala"
	replaced_individuals = _tmp0_;
#line 157 "../src/contacts-store.vala"
	_tmp1_ = gee_multi_map_get_keys (changes);
#line 157 "../src/contacts-store.vala"
	old_individuals = _tmp1_;
#line 159 "../src/contacts-store.vala"
	_tmp2_ = old_individuals;
#line 159 "../src/contacts-store.vala"
	_tmp3_ = gee_collection_get_size ((GeeCollection*) _tmp2_);
#line 159 "../src/contacts-store.vala"
	_tmp4_ = _tmp3_;
#line 159 "../src/contacts-store.vala"
	_tmp5_ = gee_multi_map_get (changes, NULL);
#line 159 "../src/contacts-store.vala"
	_tmp6_ = _tmp5_;
#line 159 "../src/contacts-store.vala"
	_tmp7_ = gee_collection_get_size (_tmp6_);
#line 159 "../src/contacts-store.vala"
	_tmp8_ = _tmp7_;
#line 159 "../src/contacts-store.vala"
	g_debug ("contacts-store.vala:159: Individuals changed: %d old, %d new", _tmp4_ - 1, _tmp8_);
#line 159 "../src/contacts-store.vala"
	_g_object_unref0 (_tmp6_);
#line 1256 "contacts-store.c"
	{
		GeeIterator* _old_individual_it = NULL;
		GeeSet* _tmp9_;
		GeeIterator* _tmp10_;
#line 162 "../src/contacts-store.vala"
		_tmp9_ = old_individuals;
#line 162 "../src/contacts-store.vala"
		_tmp10_ = gee_iterable_iterator ((GeeIterable*) _tmp9_);
#line 162 "../src/contacts-store.vala"
		_old_individual_it = _tmp10_;
#line 162 "../src/contacts-store.vala"
		while (TRUE) {
#line 1269 "contacts-store.c"
			GeeIterator* _tmp11_;
			FolksIndividual* old_individual = NULL;
			GeeIterator* _tmp12_;
			gpointer _tmp13_;
			FolksIndividual* _tmp14_;
#line 162 "../src/contacts-store.vala"
			_tmp11_ = _old_individual_it;
#line 162 "../src/contacts-store.vala"
			if (!gee_iterator_next (_tmp11_)) {
#line 162 "../src/contacts-store.vala"
				break;
#line 1281 "contacts-store.c"
			}
#line 162 "../src/contacts-store.vala"
			_tmp12_ = _old_individual_it;
#line 162 "../src/contacts-store.vala"
			_tmp13_ = gee_iterator_get (_tmp12_);
#line 162 "../src/contacts-store.vala"
			old_individual = (FolksIndividual*) _tmp13_;
#line 163 "../src/contacts-store.vala"
			_tmp14_ = old_individual;
#line 163 "../src/contacts-store.vala"
			if (_tmp14_ == NULL) {
#line 164 "../src/contacts-store.vala"
				_g_object_unref0 (old_individual);
#line 164 "../src/contacts-store.vala"
				continue;
#line 1297 "contacts-store.c"
			}
			{
				GeeIterator* _new_individual_it = NULL;
				FolksIndividual* _tmp15_;
				GeeCollection* _tmp16_;
				GeeCollection* _tmp17_;
				GeeIterator* _tmp18_;
				GeeIterator* _tmp19_;
#line 165 "../src/contacts-store.vala"
				_tmp15_ = old_individual;
#line 165 "../src/contacts-store.vala"
				_tmp16_ = gee_multi_map_get (changes, _tmp15_);
#line 165 "../src/contacts-store.vala"
				_tmp17_ = _tmp16_;
#line 165 "../src/contacts-store.vala"
				_tmp18_ = gee_iterable_iterator ((GeeIterable*) _tmp17_);
#line 165 "../src/contacts-store.vala"
				_tmp19_ = _tmp18_;
#line 165 "../src/contacts-store.vala"
				_g_object_unref0 (_tmp17_);
#line 165 "../src/contacts-store.vala"
				_new_individual_it = _tmp19_;
#line 165 "../src/contacts-store.vala"
				while (TRUE) {
#line 1322 "contacts-store.c"
					GeeIterator* _tmp20_;
					FolksIndividual* new_individual = NULL;
					GeeIterator* _tmp21_;
					gpointer _tmp22_;
					FolksIndividual* _tmp23_;
					gboolean _tmp24_ = FALSE;
					GeeHashMap* _tmp25_;
					FolksIndividual* _tmp26_;
#line 165 "../src/contacts-store.vala"
					_tmp20_ = _new_individual_it;
#line 165 "../src/contacts-store.vala"
					if (!gee_iterator_next (_tmp20_)) {
#line 165 "../src/contacts-store.vala"
						break;
#line 1337 "contacts-store.c"
					}
#line 165 "../src/contacts-store.vala"
					_tmp21_ = _new_individual_it;
#line 165 "../src/contacts-store.vala"
					_tmp22_ = gee_iterator_get (_tmp21_);
#line 165 "../src/contacts-store.vala"
					new_individual = (FolksIndividual*) _tmp22_;
#line 166 "../src/contacts-store.vala"
					_tmp23_ = new_individual;
#line 166 "../src/contacts-store.vala"
					if (_tmp23_ == NULL) {
#line 167 "../src/contacts-store.vala"
						_g_object_unref0 (new_individual);
#line 167 "../src/contacts-store.vala"
						continue;
#line 1353 "contacts-store.c"
					}
#line 168 "../src/contacts-store.vala"
					_tmp25_ = replaced_individuals;
#line 168 "../src/contacts-store.vala"
					_tmp26_ = new_individual;
#line 168 "../src/contacts-store.vala"
					if (!gee_abstract_map_has_key ((GeeAbstractMap*) _tmp25_, _tmp26_)) {
#line 168 "../src/contacts-store.vala"
						_tmp24_ = TRUE;
#line 1363 "contacts-store.c"
					} else {
						FolksIndividual* _tmp27_;
#line 169 "../src/contacts-store.vala"
						_tmp27_ = old_individual;
#line 169 "../src/contacts-store.vala"
						_tmp24_ = contacts_store_individual_should_replace_at_join (self, _tmp27_);
#line 1370 "contacts-store.c"
					}
#line 168 "../src/contacts-store.vala"
					if (_tmp24_) {
#line 1374 "contacts-store.c"
						GeeHashMap* _tmp28_;
						FolksIndividual* _tmp29_;
						FolksIndividual* _tmp30_;
#line 170 "../src/contacts-store.vala"
						_tmp28_ = replaced_individuals;
#line 170 "../src/contacts-store.vala"
						_tmp29_ = new_individual;
#line 170 "../src/contacts-store.vala"
						_tmp30_ = old_individual;
#line 170 "../src/contacts-store.vala"
						gee_abstract_map_set ((GeeAbstractMap*) _tmp28_, _tmp29_, _tmp30_);
#line 1386 "contacts-store.c"
					}
#line 165 "../src/contacts-store.vala"
					_g_object_unref0 (new_individual);
#line 1390 "contacts-store.c"
				}
#line 165 "../src/contacts-store.vala"
				_g_object_unref0 (_new_individual_it);
#line 1394 "contacts-store.c"
			}
#line 162 "../src/contacts-store.vala"
			_g_object_unref0 (old_individual);
#line 1398 "contacts-store.c"
		}
#line 162 "../src/contacts-store.vala"
		_g_object_unref0 (_old_individual_it);
#line 1402 "contacts-store.c"
	}
	{
		GeeIterator* _old_individual_it = NULL;
		GeeSet* _tmp31_;
		GeeIterator* _tmp32_;
#line 175 "../src/contacts-store.vala"
		_tmp31_ = old_individuals;
#line 175 "../src/contacts-store.vala"
		_tmp32_ = gee_iterable_iterator ((GeeIterable*) _tmp31_);
#line 175 "../src/contacts-store.vala"
		_old_individual_it = _tmp32_;
#line 175 "../src/contacts-store.vala"
		while (TRUE) {
#line 1416 "contacts-store.c"
			GeeIterator* _tmp33_;
			FolksIndividual* old_individual = NULL;
			GeeIterator* _tmp34_;
			gpointer _tmp35_;
			GeeHashSet* replacements = NULL;
			GeeHashSet* _tmp61_;
#line 175 "../src/contacts-store.vala"
			_tmp33_ = _old_individual_it;
#line 175 "../src/contacts-store.vala"
			if (!gee_iterator_next (_tmp33_)) {
#line 175 "../src/contacts-store.vala"
				break;
#line 1429 "contacts-store.c"
			}
#line 175 "../src/contacts-store.vala"
			_tmp34_ = _old_individual_it;
#line 175 "../src/contacts-store.vala"
			_tmp35_ = gee_iterator_get (_tmp34_);
#line 175 "../src/contacts-store.vala"
			old_individual = (FolksIndividual*) _tmp35_;
#line 176 "../src/contacts-store.vala"
			replacements = NULL;
#line 1439 "contacts-store.c"
			{
				GeeIterator* _new_individual_it = NULL;
				FolksIndividual* _tmp36_;
				GeeCollection* _tmp37_;
				GeeCollection* _tmp38_;
				GeeIterator* _tmp39_;
				GeeIterator* _tmp40_;
#line 177 "../src/contacts-store.vala"
				_tmp36_ = old_individual;
#line 177 "../src/contacts-store.vala"
				_tmp37_ = gee_multi_map_get (changes, _tmp36_);
#line 177 "../src/contacts-store.vala"
				_tmp38_ = _tmp37_;
#line 177 "../src/contacts-store.vala"
				_tmp39_ = gee_iterable_iterator ((GeeIterable*) _tmp38_);
#line 177 "../src/contacts-store.vala"
				_tmp40_ = _tmp39_;
#line 177 "../src/contacts-store.vala"
				_g_object_unref0 (_tmp38_);
#line 177 "../src/contacts-store.vala"
				_new_individual_it = _tmp40_;
#line 177 "../src/contacts-store.vala"
				while (TRUE) {
#line 1463 "contacts-store.c"
					GeeIterator* _tmp41_;
					FolksIndividual* new_individual = NULL;
					GeeIterator* _tmp42_;
					gpointer _tmp43_;
					gboolean _tmp44_ = FALSE;
					gboolean _tmp45_ = FALSE;
					FolksIndividual* _tmp46_;
#line 177 "../src/contacts-store.vala"
					_tmp41_ = _new_individual_it;
#line 177 "../src/contacts-store.vala"
					if (!gee_iterator_next (_tmp41_)) {
#line 177 "../src/contacts-store.vala"
						break;
#line 1477 "contacts-store.c"
					}
#line 177 "../src/contacts-store.vala"
					_tmp42_ = _new_individual_it;
#line 177 "../src/contacts-store.vala"
					_tmp43_ = gee_iterator_get (_tmp42_);
#line 177 "../src/contacts-store.vala"
					new_individual = (FolksIndividual*) _tmp43_;
#line 178 "../src/contacts-store.vala"
					_tmp46_ = old_individual;
#line 178 "../src/contacts-store.vala"
					if (_tmp46_ != NULL) {
#line 1489 "contacts-store.c"
						FolksIndividual* _tmp47_;
#line 178 "../src/contacts-store.vala"
						_tmp47_ = new_individual;
#line 178 "../src/contacts-store.vala"
						_tmp45_ = _tmp47_ != NULL;
#line 1495 "contacts-store.c"
					} else {
#line 178 "../src/contacts-store.vala"
						_tmp45_ = FALSE;
#line 1499 "contacts-store.c"
					}
#line 178 "../src/contacts-store.vala"
					if (_tmp45_) {
#line 1503 "contacts-store.c"
						GeeHashMap* _tmp48_;
						FolksIndividual* _tmp49_;
						gpointer _tmp50_;
						FolksIndividual* _tmp51_;
						FolksIndividual* _tmp52_;
#line 179 "../src/contacts-store.vala"
						_tmp48_ = replaced_individuals;
#line 179 "../src/contacts-store.vala"
						_tmp49_ = new_individual;
#line 179 "../src/contacts-store.vala"
						_tmp50_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp48_, _tmp49_);
#line 179 "../src/contacts-store.vala"
						_tmp51_ = (FolksIndividual*) _tmp50_;
#line 179 "../src/contacts-store.vala"
						_tmp52_ = old_individual;
#line 179 "../src/contacts-store.vala"
						_tmp44_ = _tmp51_ == _tmp52_;
#line 179 "../src/contacts-store.vala"
						_g_object_unref0 (_tmp51_);
#line 1523 "contacts-store.c"
					} else {
#line 178 "../src/contacts-store.vala"
						_tmp44_ = FALSE;
#line 1527 "contacts-store.c"
					}
#line 178 "../src/contacts-store.vala"
					if (_tmp44_) {
#line 1531 "contacts-store.c"
						GeeHashSet* _tmp53_;
						GeeHashSet* _tmp55_;
						FolksIndividual* _tmp56_;
#line 180 "../src/contacts-store.vala"
						_tmp53_ = replacements;
#line 180 "../src/contacts-store.vala"
						if (_tmp53_ == NULL) {
#line 1539 "contacts-store.c"
							GeeHashSet* _tmp54_;
#line 181 "../src/contacts-store.vala"
							_tmp54_ = gee_hash_set_new (FOLKS_TYPE_INDIVIDUAL, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL);
#line 181 "../src/contacts-store.vala"
							_g_object_unref0 (replacements);
#line 181 "../src/contacts-store.vala"
							replacements = _tmp54_;
#line 1547 "contacts-store.c"
						}
#line 182 "../src/contacts-store.vala"
						_tmp55_ = replacements;
#line 182 "../src/contacts-store.vala"
						_tmp56_ = new_individual;
#line 182 "../src/contacts-store.vala"
						gee_abstract_collection_add ((GeeAbstractCollection*) _tmp55_, _tmp56_);
#line 1555 "contacts-store.c"
					} else {
						FolksIndividual* _tmp57_;
#line 183 "../src/contacts-store.vala"
						_tmp57_ = old_individual;
#line 183 "../src/contacts-store.vala"
						if (_tmp57_ != NULL) {
#line 1562 "contacts-store.c"
							FolksIndividual* _tmp58_;
#line 185 "../src/contacts-store.vala"
							_tmp58_ = old_individual;
#line 185 "../src/contacts-store.vala"
							g_signal_emit (self, contacts_store_signals[CONTACTS_STORE_REMOVED_SIGNAL], 0, _tmp58_);
#line 1568 "contacts-store.c"
						} else {
							FolksIndividual* _tmp59_;
#line 186 "../src/contacts-store.vala"
							_tmp59_ = new_individual;
#line 186 "../src/contacts-store.vala"
							if (_tmp59_ != NULL) {
#line 1575 "contacts-store.c"
								FolksIndividual* _tmp60_;
#line 188 "../src/contacts-store.vala"
								_tmp60_ = new_individual;
#line 188 "../src/contacts-store.vala"
								g_signal_emit (self, contacts_store_signals[CONTACTS_STORE_ADDED_SIGNAL], 0, _tmp60_);
#line 1581 "contacts-store.c"
							}
						}
					}
#line 177 "../src/contacts-store.vala"
					_g_object_unref0 (new_individual);
#line 1587 "contacts-store.c"
				}
#line 177 "../src/contacts-store.vala"
				_g_object_unref0 (_new_individual_it);
#line 1591 "contacts-store.c"
			}
#line 197 "../src/contacts-store.vala"
			_tmp61_ = replacements;
#line 197 "../src/contacts-store.vala"
			if (_tmp61_ != NULL) {
#line 1597 "contacts-store.c"
				FolksIndividual* main_individual = NULL;
#line 198 "../src/contacts-store.vala"
				main_individual = NULL;
#line 1601 "contacts-store.c"
				{
					GeeIterator* _i_it = NULL;
					GeeHashSet* _tmp62_;
					GeeIterator* _tmp63_;
#line 199 "../src/contacts-store.vala"
					_tmp62_ = replacements;
#line 199 "../src/contacts-store.vala"
					_tmp63_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp62_);
#line 199 "../src/contacts-store.vala"
					_i_it = _tmp63_;
#line 199 "../src/contacts-store.vala"
					while (TRUE) {
#line 1614 "contacts-store.c"
						GeeIterator* _tmp64_;
						FolksIndividual* i = NULL;
						GeeIterator* _tmp65_;
						gpointer _tmp66_;
						FolksIndividual* _tmp67_;
						FolksIndividual* _tmp68_;
						FolksIndividual* _tmp69_;
#line 199 "../src/contacts-store.vala"
						_tmp64_ = _i_it;
#line 199 "../src/contacts-store.vala"
						if (!gee_iterator_next (_tmp64_)) {
#line 199 "../src/contacts-store.vala"
							break;
#line 1628 "contacts-store.c"
						}
#line 199 "../src/contacts-store.vala"
						_tmp65_ = _i_it;
#line 199 "../src/contacts-store.vala"
						_tmp66_ = gee_iterator_get (_tmp65_);
#line 199 "../src/contacts-store.vala"
						i = (FolksIndividual*) _tmp66_;
#line 200 "../src/contacts-store.vala"
						_tmp67_ = i;
#line 200 "../src/contacts-store.vala"
						_tmp68_ = _g_object_ref0 (_tmp67_);
#line 200 "../src/contacts-store.vala"
						_g_object_unref0 (main_individual);
#line 200 "../src/contacts-store.vala"
						main_individual = _tmp68_;
#line 205 "../src/contacts-store.vala"
						_tmp69_ = i;
#line 205 "../src/contacts-store.vala"
						if (contacts_store_individual_can_replace_at_split (self, _tmp69_)) {
#line 206 "../src/contacts-store.vala"
							_g_object_unref0 (i);
#line 206 "../src/contacts-store.vala"
							break;
#line 1652 "contacts-store.c"
						}
#line 199 "../src/contacts-store.vala"
						_g_object_unref0 (i);
#line 1656 "contacts-store.c"
					}
#line 199 "../src/contacts-store.vala"
					_g_object_unref0 (_i_it);
#line 1660 "contacts-store.c"
				}
				{
					GeeIterator* _i_it = NULL;
					GeeHashSet* _tmp70_;
					GeeIterator* _tmp71_;
#line 213 "../src/contacts-store.vala"
					_tmp70_ = replacements;
#line 213 "../src/contacts-store.vala"
					_tmp71_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp70_);
#line 213 "../src/contacts-store.vala"
					_i_it = _tmp71_;
#line 213 "../src/contacts-store.vala"
					while (TRUE) {
#line 1674 "contacts-store.c"
						GeeIterator* _tmp72_;
						FolksIndividual* i = NULL;
						GeeIterator* _tmp73_;
						gpointer _tmp74_;
						FolksIndividual* _tmp75_;
						FolksIndividual* _tmp76_;
#line 213 "../src/contacts-store.vala"
						_tmp72_ = _i_it;
#line 213 "../src/contacts-store.vala"
						if (!gee_iterator_next (_tmp72_)) {
#line 213 "../src/contacts-store.vala"
							break;
#line 1687 "contacts-store.c"
						}
#line 213 "../src/contacts-store.vala"
						_tmp73_ = _i_it;
#line 213 "../src/contacts-store.vala"
						_tmp74_ = gee_iterator_get (_tmp73_);
#line 213 "../src/contacts-store.vala"
						i = (FolksIndividual*) _tmp74_;
#line 214 "../src/contacts-store.vala"
						_tmp75_ = i;
#line 214 "../src/contacts-store.vala"
						_tmp76_ = main_individual;
#line 214 "../src/contacts-store.vala"
						if (_tmp75_ != _tmp76_) {
#line 1701 "contacts-store.c"
							FolksIndividual* _tmp77_;
#line 217 "../src/contacts-store.vala"
							_tmp77_ = i;
#line 217 "../src/contacts-store.vala"
							g_signal_emit (self, contacts_store_signals[CONTACTS_STORE_ADDED_SIGNAL], 0, _tmp77_);
#line 1707 "contacts-store.c"
						}
#line 213 "../src/contacts-store.vala"
						_g_object_unref0 (i);
#line 1711 "contacts-store.c"
					}
#line 213 "../src/contacts-store.vala"
					_g_object_unref0 (_i_it);
#line 1715 "contacts-store.c"
				}
#line 197 "../src/contacts-store.vala"
				_g_object_unref0 (main_individual);
#line 1719 "contacts-store.c"
			}
#line 175 "../src/contacts-store.vala"
			_g_object_unref0 (replacements);
#line 175 "../src/contacts-store.vala"
			_g_object_unref0 (old_individual);
#line 1725 "contacts-store.c"
		}
#line 175 "../src/contacts-store.vala"
		_g_object_unref0 (_old_individual_it);
#line 1729 "contacts-store.c"
	}
#line 153 "../src/contacts-store.vala"
	_g_object_unref0 (old_individuals);
#line 153 "../src/contacts-store.vala"
	_g_object_unref0 (replaced_individuals);
#line 1735 "contacts-store.c"
}

GeeCollection*
contacts_store_get_contacts (ContactsStore* self)
{
	FolksIndividualAggregator* _tmp0_;
	GeeMap* _tmp1_;
	GeeMap* _tmp2_;
	GeeCollection* _tmp3_;
	GeeCollection* _tmp4_;
	GeeCollection* _tmp5_;
	GeeCollection* _tmp6_;
	GeeCollection* _tmp7_;
	GeeCollection* _tmp8_;
	GeeCollection* result = NULL;
#line 224 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 225 "../src/contacts-store.vala"
	_tmp0_ = self->priv->_aggregator;
#line 225 "../src/contacts-store.vala"
	_tmp1_ = folks_individual_aggregator_get_individuals (_tmp0_);
#line 225 "../src/contacts-store.vala"
	_tmp2_ = _tmp1_;
#line 225 "../src/contacts-store.vala"
	_tmp3_ = gee_map_get_values (_tmp2_);
#line 225 "../src/contacts-store.vala"
	_tmp4_ = _tmp3_;
#line 225 "../src/contacts-store.vala"
	_tmp5_ = _tmp4_;
#line 225 "../src/contacts-store.vala"
	_tmp6_ = gee_collection_get_read_only_view (_tmp5_);
#line 225 "../src/contacts-store.vala"
	_tmp7_ = _tmp6_;
#line 225 "../src/contacts-store.vala"
	_tmp8_ = _tmp7_;
#line 225 "../src/contacts-store.vala"
	_g_object_unref0 (_tmp5_);
#line 225 "../src/contacts-store.vala"
	result = _tmp8_;
#line 225 "../src/contacts-store.vala"
	return result;
#line 1777 "contacts-store.c"
}

static void
contacts_store_find_contact_data_free (gpointer _data)
{
	ContactsStoreFindContactData* _data_;
	_data_ = _data;
#line 22 "../src/contacts-store.vala"
	_g_object_unref0 (_data_->query);
#line 22 "../src/contacts-store.vala"
	_g_object_unref0 (_data_->result);
#line 22 "../src/contacts-store.vala"
	_g_object_unref0 (_data_->self);
#line 22 "../src/contacts-store.vala"
	g_slice_free (ContactsStoreFindContactData, _data_);
#line 1793 "contacts-store.c"
}

void
contacts_store_find_contact (ContactsStore* self,
                             FolksQuery* query,
                             GAsyncReadyCallback _callback_,
                             gpointer _user_data_)
{
	ContactsStoreFindContactData* _data_;
	ContactsStore* _tmp0_;
	FolksQuery* _tmp1_;
#line 22 "../src/contacts-store.vala"
	_data_ = g_slice_new0 (ContactsStoreFindContactData);
#line 22 "../src/contacts-store.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 22 "../src/contacts-store.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_store_find_contact_data_free);
#line 22 "../src/contacts-store.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 22 "../src/contacts-store.vala"
	_data_->self = _tmp0_;
#line 22 "../src/contacts-store.vala"
	_tmp1_ = _g_object_ref0 (query);
#line 22 "../src/contacts-store.vala"
	_g_object_unref0 (_data_->query);
#line 22 "../src/contacts-store.vala"
	_data_->query = _tmp1_;
#line 22 "../src/contacts-store.vala"
	contacts_store_find_contact_co (_data_);
#line 1823 "contacts-store.c"
}

FolksIndividual*
contacts_store_find_contact_finish (ContactsStore* self,
                                    GAsyncResult* _res_)
{
	FolksIndividual* result;
	ContactsStoreFindContactData* _data_;
#line 22 "../src/contacts-store.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 22 "../src/contacts-store.vala"
	result = _data_->result;
#line 22 "../src/contacts-store.vala"
	_data_->result = NULL;
#line 22 "../src/contacts-store.vala"
	return result;
#line 1840 "contacts-store.c"
}

static Block2Data*
block2_data_ref (Block2Data* _data2_)
{
#line 230 "../src/contacts-store.vala"
	g_atomic_int_inc (&_data2_->_ref_count_);
#line 230 "../src/contacts-store.vala"
	return _data2_;
#line 1850 "contacts-store.c"
}

static void
block2_data_unref (void * _userdata_)
{
	Block2Data* _data2_;
	_data2_ = (Block2Data*) _userdata_;
#line 230 "../src/contacts-store.vala"
	if (g_atomic_int_dec_and_test (&_data2_->_ref_count_)) {
#line 1860 "contacts-store.c"
		ContactsStore* self;
#line 230 "../src/contacts-store.vala"
		self = _data2_->self;
#line 230 "../src/contacts-store.vala"
		(_data2_->callback_target_destroy_notify == NULL) ? NULL : (_data2_->callback_target_destroy_notify (_data2_->callback_target), NULL);
#line 230 "../src/contacts-store.vala"
		_data2_->callback = NULL;
#line 230 "../src/contacts-store.vala"
		_data2_->callback_target = NULL;
#line 230 "../src/contacts-store.vala"
		_data2_->callback_target_destroy_notify = NULL;
#line 230 "../src/contacts-store.vala"
		_g_object_unref0 (self);
#line 230 "../src/contacts-store.vala"
		g_slice_free (Block2Data, _data2_);
#line 1876 "contacts-store.c"
	}
}

static gboolean
_contacts_store_find_contact_co_gsource_func (gpointer self)
{
	gboolean result;
	result = contacts_store_find_contact_co (self);
#line 232 "../src/contacts-store.vala"
	return result;
#line 1887 "contacts-store.c"
}

static void
___lambda7_ (Block2Data* _data2_)
{
	ContactsStore* self;
	GSourceFunc _tmp0_;
	gpointer _tmp0__target;
#line 233 "../src/contacts-store.vala"
	self = _data2_->self;
#line 234 "../src/contacts-store.vala"
	_tmp0_ = _data2_->callback;
#line 234 "../src/contacts-store.vala"
	_tmp0__target = _data2_->callback_target;
#line 234 "../src/contacts-store.vala"
	_tmp0_ (_tmp0__target);
#line 1904 "contacts-store.c"
}

static void
____lambda7__contacts_store_quiescent (ContactsStore* _sender,
                                       gpointer self)
{
#line 233 "../src/contacts-store.vala"
	___lambda7_ (self);
#line 1913 "contacts-store.c"
}

static gboolean
contacts_store_find_contact_co (ContactsStoreFindContactData* _data_)
{
#line 228 "../src/contacts-store.vala"
	switch (_data_->_state_) {
#line 228 "../src/contacts-store.vala"
		case 0:
#line 1923 "contacts-store.c"
		goto _state_0;
#line 228 "../src/contacts-store.vala"
		case 1:
#line 1927 "contacts-store.c"
		goto _state_1;
		default:
#line 228 "../src/contacts-store.vala"
		g_assert_not_reached ();
#line 1932 "contacts-store.c"
	}
	_state_0:
#line 230 "../src/contacts-store.vala"
	_data_->_tmp0_ = contacts_store_get_is_quiescent (_data_->self);
#line 230 "../src/contacts-store.vala"
	_data_->_tmp1_ = _data_->_tmp0_;
#line 230 "../src/contacts-store.vala"
	if (!_data_->_tmp1_) {
#line 230 "../src/contacts-store.vala"
		_data_->_data2_ = g_slice_new0 (Block2Data);
#line 230 "../src/contacts-store.vala"
		_data_->_data2_->_ref_count_ = 1;
#line 230 "../src/contacts-store.vala"
		_data_->_data2_->self = g_object_ref (_data_->self);
#line 232 "../src/contacts-store.vala"
		_data_->_data2_->callback = _contacts_store_find_contact_co_gsource_func;
#line 232 "../src/contacts-store.vala"
		_data_->_data2_->callback_target = _data_;
#line 232 "../src/contacts-store.vala"
		_data_->_data2_->callback_target_destroy_notify = NULL;
#line 233 "../src/contacts-store.vala"
		_data_->_tmp2_ = g_signal_connect_data (_data_->self, "quiescent", (GCallback) ____lambda7__contacts_store_quiescent, block2_data_ref (_data_->_data2_), (GClosureNotify) block2_data_unref, 0);
#line 233 "../src/contacts-store.vala"
		_data_->signal_id = _data_->_tmp2_;
#line 236 "../src/contacts-store.vala"
		_data_->_state_ = 1;
#line 236 "../src/contacts-store.vala"
		return FALSE;
#line 1961 "contacts-store.c"
		_state_1:
		;
#line 237 "../src/contacts-store.vala"
		g_signal_handler_disconnect ((GObject*) _data_->self, _data_->signal_id);
#line 230 "../src/contacts-store.vala"
		block2_data_unref (_data_->_data2_);
#line 230 "../src/contacts-store.vala"
		_data_->_data2_ = NULL;
#line 1970 "contacts-store.c"
	}
#line 240 "../src/contacts-store.vala"
	_data_->matched = NULL;
#line 242 "../src/contacts-store.vala"
	_data_->strength = (guint) 0;
#line 1976 "contacts-store.c"
	{
#line 243 "../src/contacts-store.vala"
		_data_->_tmp3_ = _data_->self->priv->_aggregator;
#line 243 "../src/contacts-store.vala"
		_data_->_tmp4_ = folks_individual_aggregator_get_individuals (_data_->_tmp3_);
#line 243 "../src/contacts-store.vala"
		_data_->_tmp5_ = _data_->_tmp4_;
#line 243 "../src/contacts-store.vala"
		_data_->_tmp6_ = gee_map_get_values (_data_->_tmp5_);
#line 243 "../src/contacts-store.vala"
		_data_->_tmp7_ = _data_->_tmp6_;
#line 243 "../src/contacts-store.vala"
		_data_->_tmp8_ = _data_->_tmp7_;
#line 243 "../src/contacts-store.vala"
		_data_->_tmp9_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp8_);
#line 243 "../src/contacts-store.vala"
		_data_->_tmp10_ = _data_->_tmp9_;
#line 243 "../src/contacts-store.vala"
		_g_object_unref0 (_data_->_tmp8_);
#line 243 "../src/contacts-store.vala"
		_data_->_i_it = _data_->_tmp10_;
#line 243 "../src/contacts-store.vala"
		while (TRUE) {
#line 243 "../src/contacts-store.vala"
			_data_->_tmp11_ = _data_->_i_it;
#line 243 "../src/contacts-store.vala"
			if (!gee_iterator_next (_data_->_tmp11_)) {
#line 243 "../src/contacts-store.vala"
				break;
#line 2006 "contacts-store.c"
			}
#line 243 "../src/contacts-store.vala"
			_data_->_tmp12_ = _data_->_i_it;
#line 243 "../src/contacts-store.vala"
			_data_->_tmp13_ = gee_iterator_get (_data_->_tmp12_);
#line 243 "../src/contacts-store.vala"
			_data_->i = (FolksIndividual*) _data_->_tmp13_;
#line 244 "../src/contacts-store.vala"
			_data_->_tmp14_ = _data_->i;
#line 244 "../src/contacts-store.vala"
			_data_->this_strength = folks_query_is_match (_data_->query, _data_->_tmp14_);
#line 245 "../src/contacts-store.vala"
			if (_data_->this_strength > _data_->strength) {
#line 246 "../src/contacts-store.vala"
				_data_->_tmp15_ = _data_->i;
#line 246 "../src/contacts-store.vala"
				_data_->_tmp16_ = _g_object_ref0 (_data_->_tmp15_);
#line 246 "../src/contacts-store.vala"
				_g_object_unref0 (_data_->matched);
#line 246 "../src/contacts-store.vala"
				_data_->matched = _data_->_tmp16_;
#line 247 "../src/contacts-store.vala"
				_data_->strength = _data_->this_strength;
#line 2030 "contacts-store.c"
			}
#line 243 "../src/contacts-store.vala"
			_g_object_unref0 (_data_->i);
#line 2034 "contacts-store.c"
		}
#line 243 "../src/contacts-store.vala"
		_g_object_unref0 (_data_->_i_it);
#line 2038 "contacts-store.c"
	}
#line 251 "../src/contacts-store.vala"
	_data_->result = _data_->matched;
#line 251 "../src/contacts-store.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 251 "../src/contacts-store.vala"
	if (_data_->_state_ != 0) {
#line 251 "../src/contacts-store.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 251 "../src/contacts-store.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 2050 "contacts-store.c"
		}
	}
#line 251 "../src/contacts-store.vala"
	g_object_unref (_data_->_async_result);
#line 251 "../src/contacts-store.vala"
	return FALSE;
#line 2057 "contacts-store.c"
}

ContactsStore*
contacts_store_construct (GType object_type)
{
	ContactsStore * self = NULL;
#line 22 "../src/contacts-store.vala"
	self = (ContactsStore*) g_object_new (object_type, NULL);
#line 22 "../src/contacts-store.vala"
	return self;
#line 2068 "contacts-store.c"
}

ContactsStore*
contacts_store_new (void)
{
#line 22 "../src/contacts-store.vala"
	return contacts_store_construct (CONTACTS_TYPE_STORE);
#line 2076 "contacts-store.c"
}

FolksIndividualAggregator*
contacts_store_get_aggregator (ContactsStore* self)
{
	FolksIndividualAggregator* result;
	FolksIndividualAggregator* _tmp0_;
#line 28 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 28 "../src/contacts-store.vala"
	_tmp0_ = self->priv->_aggregator;
#line 28 "../src/contacts-store.vala"
	result = _tmp0_;
#line 28 "../src/contacts-store.vala"
	return result;
#line 2092 "contacts-store.c"
}

static void
contacts_store_set_aggregator (ContactsStore* self,
                               FolksIndividualAggregator* value)
{
#line 28 "../src/contacts-store.vala"
	g_return_if_fail (self != NULL);
#line 28 "../src/contacts-store.vala"
	if (contacts_store_get_aggregator (self) != value) {
#line 2103 "contacts-store.c"
		FolksIndividualAggregator* _tmp0_;
#line 28 "../src/contacts-store.vala"
		_tmp0_ = _g_object_ref0 (value);
#line 28 "../src/contacts-store.vala"
		_g_object_unref0 (self->priv->_aggregator);
#line 28 "../src/contacts-store.vala"
		self->priv->_aggregator = _tmp0_;
#line 28 "../src/contacts-store.vala"
		g_object_notify_by_pspec ((GObject *) self, contacts_store_properties[CONTACTS_STORE_AGGREGATOR_PROPERTY]);
#line 2113 "contacts-store.c"
	}
}

FolksBackendStore*
contacts_store_get_backend_store (ContactsStore* self)
{
	FolksBackendStore* result;
	FolksIndividualAggregator* _tmp0_;
	FolksBackendStore* _tmp1_;
	FolksBackendStore* _tmp2_;
#line 29 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 29 "../src/contacts-store.vala"
	_tmp0_ = self->priv->_aggregator;
#line 29 "../src/contacts-store.vala"
	_tmp1_ = folks_individual_aggregator_get_backend_store (_tmp0_);
#line 29 "../src/contacts-store.vala"
	_tmp2_ = _tmp1_;
#line 29 "../src/contacts-store.vala"
	result = _tmp2_;
#line 29 "../src/contacts-store.vala"
	return result;
#line 2136 "contacts-store.c"
}

gboolean
contacts_store_get_is_quiescent (ContactsStore* self)
{
	gboolean result;
	FolksIndividualAggregator* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
#line 38 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 38 "../src/contacts-store.vala"
	_tmp0_ = self->priv->_aggregator;
#line 38 "../src/contacts-store.vala"
	_tmp1_ = folks_individual_aggregator_get_is_quiescent (_tmp0_);
#line 38 "../src/contacts-store.vala"
	_tmp2_ = _tmp1_;
#line 38 "../src/contacts-store.vala"
	result = _tmp2_;
#line 38 "../src/contacts-store.vala"
	return result;
#line 2158 "contacts-store.c"
}

gboolean
contacts_store_get_is_prepared (ContactsStore* self)
{
	gboolean result;
	FolksIndividualAggregator* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
#line 42 "../src/contacts-store.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 42 "../src/contacts-store.vala"
	_tmp0_ = self->priv->_aggregator;
#line 42 "../src/contacts-store.vala"
	_tmp1_ = folks_individual_aggregator_get_is_prepared (_tmp0_);
#line 42 "../src/contacts-store.vala"
	_tmp2_ = _tmp1_;
#line 42 "../src/contacts-store.vala"
	result = _tmp2_;
#line 42 "../src/contacts-store.vala"
	return result;
#line 2180 "contacts-store.c"
}

static gboolean
__lambda9_ (ContactsStore* self)
{
	gboolean result = FALSE;
#line 133 "../src/contacts-store.vala"
	g_signal_emit (self, contacts_store_signals[CONTACTS_STORE_QUIESCENT_SIGNAL], 0);
#line 134 "../src/contacts-store.vala"
	result = FALSE;
#line 134 "../src/contacts-store.vala"
	return result;
#line 2193 "contacts-store.c"
}

static gboolean
___lambda9__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda9_ ((ContactsStore*) self);
#line 132 "../src/contacts-store.vala"
	return result;
#line 2203 "contacts-store.c"
}

static void
_contacts_store___lambda8_ (ContactsStore* self,
                            GObject* obj,
                            GParamSpec* pspec)
{
#line 130 "../src/contacts-store.vala"
	g_return_if_fail (obj != NULL);
#line 130 "../src/contacts-store.vala"
	g_return_if_fail (pspec != NULL);
#line 132 "../src/contacts-store.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda9__gsource_func, g_object_ref (self), g_object_unref);
#line 2217 "contacts-store.c"
}

static void
__contacts_store___lambda8__g_object_notify (GObject* _sender,
                                             GParamSpec* pspec,
                                             gpointer self)
{
#line 130 "../src/contacts-store.vala"
	_contacts_store___lambda8_ ((ContactsStore*) self, _sender, pspec);
#line 2227 "contacts-store.c"
}

static gboolean
__lambda11_ (ContactsStore* self)
{
	gboolean result = FALSE;
#line 140 "../src/contacts-store.vala"
	g_signal_emit (self, contacts_store_signals[CONTACTS_STORE_PREPARED_SIGNAL], 0);
#line 141 "../src/contacts-store.vala"
	result = FALSE;
#line 141 "../src/contacts-store.vala"
	return result;
#line 2240 "contacts-store.c"
}

static gboolean
___lambda11__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda11_ ((ContactsStore*) self);
#line 139 "../src/contacts-store.vala"
	return result;
#line 2250 "contacts-store.c"
}

static void
_contacts_store___lambda10_ (ContactsStore* self,
                             GObject* obj,
                             GParamSpec* pspec)
{
#line 138 "../src/contacts-store.vala"
	g_return_if_fail (obj != NULL);
#line 138 "../src/contacts-store.vala"
	g_return_if_fail (pspec != NULL);
#line 139 "../src/contacts-store.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda11__gsource_func, g_object_ref (self), g_object_unref);
#line 2264 "contacts-store.c"
}

static void
__contacts_store___lambda10__g_object_notify (GObject* _sender,
                                              GParamSpec* pspec,
                                              gpointer self)
{
#line 138 "../src/contacts-store.vala"
	_contacts_store___lambda10_ ((ContactsStore*) self, _sender, pspec);
#line 2274 "contacts-store.c"
}

static void
_contacts_store_on_individuals_changed_detailed_folks_individual_aggregator_individuals_changed_detailed (FolksIndividualAggregator* _sender,
                                                                                                          GeeMultiMap* changes,
                                                                                                          gpointer self)
{
#line 145 "../src/contacts-store.vala"
	contacts_store_on_individuals_changed_detailed ((ContactsStore*) self, changes);
#line 2284 "contacts-store.c"
}

static GObject *
contacts_store_constructor (GType type,
                            guint n_construct_properties,
                            GObjectConstructParam * construct_properties)
{
	GObject * obj;
	GObjectClass * parent_class;
	ContactsStore * self;
	GeeHashMultiMap* _tmp0_;
	FolksBackendStore* backend_store = NULL;
	FolksBackendStore* _tmp1_;
	FolksBackendStore* _tmp2_;
	FolksIndividualAggregator* _tmp3_;
	FolksIndividualAggregator* _tmp4_;
	FolksIndividualAggregator* _tmp5_;
	FolksIndividualAggregator* _tmp6_;
	FolksIndividualAggregator* _tmp7_;
	FolksIndividualAggregator* _tmp8_;
#line 123 "../src/contacts-store.vala"
	parent_class = G_OBJECT_CLASS (contacts_store_parent_class);
#line 123 "../src/contacts-store.vala"
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
#line 123 "../src/contacts-store.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_STORE, ContactsStore);
#line 124 "../src/contacts-store.vala"
	_tmp0_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 124 "../src/contacts-store.vala"
	_g_object_unref0 (self->dont_suggest_link);
#line 124 "../src/contacts-store.vala"
	self->dont_suggest_link = _tmp0_;
#line 125 "../src/contacts-store.vala"
	contacts_store_read_dont_suggest_db (self);
#line 127 "../src/contacts-store.vala"
	_tmp1_ = folks_backend_store_dup ();
#line 127 "../src/contacts-store.vala"
	backend_store = _tmp1_;
#line 129 "../src/contacts-store.vala"
	_tmp2_ = backend_store;
#line 129 "../src/contacts-store.vala"
	_tmp3_ = folks_individual_aggregator_dup_with_backend_store (_tmp2_);
#line 129 "../src/contacts-store.vala"
	_tmp4_ = _tmp3_;
#line 129 "../src/contacts-store.vala"
	contacts_store_set_aggregator (self, _tmp4_);
#line 129 "../src/contacts-store.vala"
	_g_object_unref0 (_tmp4_);
#line 130 "../src/contacts-store.vala"
	_tmp5_ = self->priv->_aggregator;
#line 130 "../src/contacts-store.vala"
	g_signal_connect_object ((GObject*) _tmp5_, "notify::is-quiescent", (GCallback) __contacts_store___lambda8__g_object_notify, self, 0);
#line 138 "../src/contacts-store.vala"
	_tmp6_ = self->priv->_aggregator;
#line 138 "../src/contacts-store.vala"
	g_signal_connect_object ((GObject*) _tmp6_, "notify::is-prepared", (GCallback) __contacts_store___lambda10__g_object_notify, self, 0);
#line 145 "../src/contacts-store.vala"
	_tmp7_ = self->priv->_aggregator;
#line 145 "../src/contacts-store.vala"
	g_signal_connect_object (_tmp7_, "individuals-changed-detailed", (GCallback) _contacts_store_on_individuals_changed_detailed_folks_individual_aggregator_individuals_changed_detailed, self, 0);
#line 146 "../src/contacts-store.vala"
	_tmp8_ = self->priv->_aggregator;
#line 146 "../src/contacts-store.vala"
	folks_individual_aggregator_prepare (_tmp8_, NULL, NULL);
#line 123 "../src/contacts-store.vala"
	_g_object_unref0 (backend_store);
#line 123 "../src/contacts-store.vala"
	return obj;
#line 2353 "contacts-store.c"
}

static void
contacts_store_class_init (ContactsStoreClass * klass,
                           gpointer klass_data)
{
#line 22 "../src/contacts-store.vala"
	contacts_store_parent_class = g_type_class_peek_parent (klass);
#line 22 "../src/contacts-store.vala"
	g_type_class_adjust_private_offset (klass, &ContactsStore_private_offset);
#line 22 "../src/contacts-store.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_contacts_store_get_property;
#line 22 "../src/contacts-store.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_contacts_store_set_property;
#line 22 "../src/contacts-store.vala"
	G_OBJECT_CLASS (klass)->constructor = contacts_store_constructor;
#line 22 "../src/contacts-store.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_store_finalize;
#line 22 "../src/contacts-store.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_STORE_AGGREGATOR_PROPERTY, contacts_store_properties[CONTACTS_STORE_AGGREGATOR_PROPERTY] = g_param_spec_object ("aggregator", "aggregator", "aggregator", FOLKS_TYPE_INDIVIDUAL_AGGREGATOR, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 22 "../src/contacts-store.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_STORE_BACKEND_STORE_PROPERTY, contacts_store_properties[CONTACTS_STORE_BACKEND_STORE_PROPERTY] = g_param_spec_object ("backend-store", "backend-store", "backend-store", FOLKS_TYPE_BACKEND_STORE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 22 "../src/contacts-store.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_STORE_IS_QUIESCENT_PROPERTY, contacts_store_properties[CONTACTS_STORE_IS_QUIESCENT_PROPERTY] = g_param_spec_boolean ("is-quiescent", "is-quiescent", "is-quiescent", FALSE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 22 "../src/contacts-store.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_STORE_IS_PREPARED_PROPERTY, contacts_store_properties[CONTACTS_STORE_IS_PREPARED_PROPERTY] = g_param_spec_boolean ("is-prepared", "is-prepared", "is-prepared", FALSE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 22 "../src/contacts-store.vala"
	contacts_store_signals[CONTACTS_STORE_ADDED_SIGNAL] = g_signal_new ("added", CONTACTS_TYPE_STORE, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__OBJECT, G_TYPE_NONE, 1, FOLKS_TYPE_INDIVIDUAL);
#line 22 "../src/contacts-store.vala"
	contacts_store_signals[CONTACTS_STORE_REMOVED_SIGNAL] = g_signal_new ("removed", CONTACTS_TYPE_STORE, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__OBJECT, G_TYPE_NONE, 1, FOLKS_TYPE_INDIVIDUAL);
#line 22 "../src/contacts-store.vala"
	contacts_store_signals[CONTACTS_STORE_QUIESCENT_SIGNAL] = g_signal_new ("quiescent", CONTACTS_TYPE_STORE, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
#line 22 "../src/contacts-store.vala"
	contacts_store_signals[CONTACTS_STORE_PREPARED_SIGNAL] = g_signal_new ("prepared", CONTACTS_TYPE_STORE, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
#line 2388 "contacts-store.c"
}

static void
contacts_store_instance_init (ContactsStore * self,
                              gpointer klass)
{
#line 22 "../src/contacts-store.vala"
	self->priv = contacts_store_get_instance_private (self);
#line 2397 "contacts-store.c"
}

static void
contacts_store_finalize (GObject * obj)
{
	ContactsStore * self;
#line 22 "../src/contacts-store.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_STORE, ContactsStore);
#line 28 "../src/contacts-store.vala"
	_g_object_unref0 (self->priv->_aggregator);
#line 31 "../src/contacts-store.vala"
	_g_object_unref0 (self->dont_suggest_link);
#line 22 "../src/contacts-store.vala"
	G_OBJECT_CLASS (contacts_store_parent_class)->finalize (obj);
#line 2412 "contacts-store.c"
}

static GType
contacts_store_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsStoreClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_store_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsStore), 0, (GInstanceInitFunc) contacts_store_instance_init, NULL };
	GType contacts_store_type_id;
	contacts_store_type_id = g_type_register_static (G_TYPE_OBJECT, "ContactsStore", &g_define_type_info, 0);
	ContactsStore_private_offset = g_type_add_instance_private (contacts_store_type_id, sizeof (ContactsStorePrivate));
	return contacts_store_type_id;
}

GType
contacts_store_get_type (void)
{
	static volatile gsize contacts_store_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_store_type_id__volatile)) {
		GType contacts_store_type_id;
		contacts_store_type_id = contacts_store_get_type_once ();
		g_once_init_leave (&contacts_store_type_id__volatile, contacts_store_type_id);
	}
	return contacts_store_type_id__volatile;
}

static void
_vala_contacts_store_get_property (GObject * object,
                                   guint property_id,
                                   GValue * value,
                                   GParamSpec * pspec)
{
	ContactsStore * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, CONTACTS_TYPE_STORE, ContactsStore);
#line 22 "../src/contacts-store.vala"
	switch (property_id) {
#line 22 "../src/contacts-store.vala"
		case CONTACTS_STORE_AGGREGATOR_PROPERTY:
#line 22 "../src/contacts-store.vala"
		g_value_set_object (value, contacts_store_get_aggregator (self));
#line 22 "../src/contacts-store.vala"
		break;
#line 22 "../src/contacts-store.vala"
		case CONTACTS_STORE_BACKEND_STORE_PROPERTY:
#line 22 "../src/contacts-store.vala"
		g_value_set_object (value, contacts_store_get_backend_store (self));
#line 22 "../src/contacts-store.vala"
		break;
#line 22 "../src/contacts-store.vala"
		case CONTACTS_STORE_IS_QUIESCENT_PROPERTY:
#line 22 "../src/contacts-store.vala"
		g_value_set_boolean (value, contacts_store_get_is_quiescent (self));
#line 22 "../src/contacts-store.vala"
		break;
#line 22 "../src/contacts-store.vala"
		case CONTACTS_STORE_IS_PREPARED_PROPERTY:
#line 22 "../src/contacts-store.vala"
		g_value_set_boolean (value, contacts_store_get_is_prepared (self));
#line 22 "../src/contacts-store.vala"
		break;
#line 2471 "contacts-store.c"
		default:
#line 22 "../src/contacts-store.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 22 "../src/contacts-store.vala"
		break;
#line 2477 "contacts-store.c"
	}
}

static void
_vala_contacts_store_set_property (GObject * object,
                                   guint property_id,
                                   const GValue * value,
                                   GParamSpec * pspec)
{
	ContactsStore * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, CONTACTS_TYPE_STORE, ContactsStore);
#line 22 "../src/contacts-store.vala"
	switch (property_id) {
#line 22 "../src/contacts-store.vala"
		case CONTACTS_STORE_AGGREGATOR_PROPERTY:
#line 22 "../src/contacts-store.vala"
		contacts_store_set_aggregator (self, g_value_get_object (value));
#line 22 "../src/contacts-store.vala"
		break;
#line 2497 "contacts-store.c"
		default:
#line 22 "../src/contacts-store.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 22 "../src/contacts-store.vala"
		break;
#line 2503 "contacts-store.c"
	}
}

static void
_vala_array_destroy (gpointer array,
                     gint array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		gint i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}

static void
_vala_array_free (gpointer array,
                  gint array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}

static gint
_vala_array_length (gpointer array)
{
	gint length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}

