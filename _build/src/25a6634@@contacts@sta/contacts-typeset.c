/* contacts-typeset.c generated by valac 0.47.2.1-ce69, the Vala compiler
 * generated from contacts-typeset.vala, do not modify */

/*
 * Copyright (C) 2011 Alexander Larsson <alexl@redhat.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <gee.h>
#include <gtk/gtk.h>
#include <glib/gi18n-lib.h>
#include <folks/folks.h>

#define CONTACTS_TYPE_TYPESET (contacts_typeset_get_type ())
#define CONTACTS_TYPESET(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_TYPESET, ContactsTypeSet))
#define CONTACTS_TYPESET_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_TYPESET, ContactsTypeSetClass))
#define CONTACTS_IS_TYPESET(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_TYPESET))
#define CONTACTS_IS_TYPESET_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_TYPESET))
#define CONTACTS_TYPESET_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_TYPESET, ContactsTypeSetClass))

typedef struct _ContactsTypeSet ContactsTypeSet;
typedef struct _ContactsTypeSetClass ContactsTypeSetClass;
typedef struct _ContactsTypeSetPrivate ContactsTypeSetPrivate;

#define CONTACTS_TYPE_TYPEDESCRIPTOR (contacts_typedescriptor_get_type ())
#define CONTACTS_TYPEDESCRIPTOR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_TYPEDESCRIPTOR, ContactsTypeDescriptor))
#define CONTACTS_TYPEDESCRIPTOR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_TYPEDESCRIPTOR, ContactsTypeDescriptorClass))
#define CONTACTS_IS_TYPEDESCRIPTOR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_TYPEDESCRIPTOR))
#define CONTACTS_IS_TYPEDESCRIPTOR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_TYPEDESCRIPTOR))
#define CONTACTS_TYPEDESCRIPTOR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_TYPEDESCRIPTOR, ContactsTypeDescriptorClass))

typedef struct _ContactsTypeDescriptor ContactsTypeDescriptor;
typedef struct _ContactsTypeDescriptorClass ContactsTypeDescriptorClass;

#define CONTACTS_TYPE_VCARD_TYPE_MAPPING (contacts_vcard_type_mapping_get_type ())
typedef struct _ContactsVcardTypeMapping ContactsVcardTypeMapping;
enum  {
	CONTACTS_TYPESET_0_PROPERTY,
	CONTACTS_TYPESET_CATEGORY_PROPERTY,
	CONTACTS_TYPESET_STORE_PROPERTY,
	CONTACTS_TYPESET_NUM_PROPERTIES
};
static GParamSpec* contacts_typeset_properties[CONTACTS_TYPESET_NUM_PROPERTIES];
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
typedef struct _ContactsTypeDescriptorPrivate ContactsTypeDescriptorPrivate;
#define _contacts_vcard_type_mapping_free0(var) ((var == NULL) ? NULL : (var = (contacts_vcard_type_mapping_free (var), NULL)))

struct _ContactsTypeSet {
	GObject parent_instance;
	ContactsTypeSetPrivate * priv;
};

struct _ContactsTypeSetClass {
	GObjectClass parent_class;
};

struct _ContactsVcardTypeMapping {
	const gchar* name;
	const gchar* types[3];
};

struct _ContactsTypeSetPrivate {
	gchar* _category;
	ContactsTypeDescriptor* other_dummy;
	GeeList* vcard_type_mappings;
	GtkListStore* _store;
};

struct _ContactsTypeDescriptor {
	GObject parent_instance;
	ContactsTypeDescriptorPrivate * priv;
	gchar* name;
	gchar** vcard_types;
	gint vcard_types_length1;
	GtkTreeIter iter;
};

struct _ContactsTypeDescriptorClass {
	GObjectClass parent_class;
};

static gint ContactsTypeSet_private_offset;
static gpointer contacts_typeset_parent_class = NULL;
static ContactsTypeSet* contacts_typeset__general;
static ContactsTypeSet* contacts_typeset__general = NULL;
static ContactsTypeSet* contacts_typeset__email;
static ContactsTypeSet* contacts_typeset__email = NULL;
static ContactsTypeSet* contacts_typeset__phone;
static ContactsTypeSet* contacts_typeset__phone = NULL;

GType contacts_typeset_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsTypeSet, g_object_unref)
GType contacts_typedescriptor_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsTypeDescriptor, g_object_unref)
GType contacts_vcard_type_mapping_get_type (void) G_GNUC_CONST;
ContactsVcardTypeMapping* contacts_vcard_type_mapping_dup (const ContactsVcardTypeMapping* self);
void contacts_vcard_type_mapping_free (ContactsVcardTypeMapping* self);
ContactsTypeDescriptor* contacts_typedescriptor_new_other (void);
ContactsTypeDescriptor* contacts_typedescriptor_construct_other (GType object_type);
static ContactsTypeSet* contacts_typeset_new (const gchar* category);
static ContactsTypeSet* contacts_typeset_construct (GType object_type,
                                             const gchar* category);
static void contacts_typeset_set_store (ContactsTypeSet* self,
                                 GtkListStore* value);
void contacts_typeset_get_iter_for_field_details (ContactsTypeSet* self,
                                                  FolksAbstractFieldDetails* detail,
                                                  GtkTreeIter* iter);
ContactsTypeDescriptor* contacts_typeset_lookup_descriptor_for_field_details (ContactsTypeSet* self,
                                                                              FolksAbstractFieldDetails* detail);
void contacts_typeset_get_iter_for_vcard_type (ContactsTypeSet* self,
                                               const gchar* type,
                                               GtkTreeIter* iter);
static ContactsTypeDescriptor* contacts_typeset_lookup_descriptor_by_vcard_type (ContactsTypeSet* self,
                                                                          const gchar* str);
void contacts_typeset_get_iter_for_custom_label (ContactsTypeSet* self,
                                                 const gchar* label,
                                                 GtkTreeIter* iter);
ContactsTypeDescriptor* contacts_typeset_get_descriptor_for_custom_label (ContactsTypeSet* self,
                                                                          const gchar* label);
static ContactsTypeDescriptor* contacts_typeset_create_descriptor_for_custom_label (ContactsTypeSet* self,
                                                                             const gchar* label);
gchar* contacts_typeset_format_type (ContactsTypeSet* self,
                                     FolksAbstractFieldDetails* detail);
const gchar* contacts_typedescriptor_get_display_name (ContactsTypeDescriptor* self);
static void contacts_typeset_add_descriptor_to_store (ContactsTypeSet* self,
                                               ContactsTypeDescriptor* descriptor);
const gchar* contacts_typeset_get_category (ContactsTypeSet* self);
gchar* contacts_typedescriptor_to_string (ContactsTypeDescriptor* self);
gboolean contacts_typedescriptor_is_custom (ContactsTypeDescriptor* self);
GtkListStore* contacts_typeset_get_store (ContactsTypeSet* self);
ContactsTypeDescriptor* contacts_typeset_lookup_descriptor_in_store (ContactsTypeSet* self,
                                                                     const gchar* display_name);
static void contacts_typeset_add_vcard_mapping (ContactsTypeSet* self,
                                         ContactsVcardTypeMapping* vcard_mapping);
ContactsTypeDescriptor* contacts_typedescriptor_new_vcard (const gchar* untranslated_name,
                                                           gchar** types,
                                                           gint types_length1);
ContactsTypeDescriptor* contacts_typedescriptor_construct_vcard (GType object_type,
                                                                 const gchar* untranslated_name,
                                                                 gchar** types,
                                                                 gint types_length1);
static void contacts_typeset_add_type_other (ContactsTypeSet* self);
ContactsTypeDescriptor* contacts_typedescriptor_new_custom (const gchar* name);
ContactsTypeDescriptor* contacts_typedescriptor_construct_custom (GType object_type,
                                                                  const gchar* name);
gboolean contacts_vcard_type_mapping_contains (ContactsVcardTypeMapping *self,
                                               const gchar* type);
#define CONTACTS_TYPEDESCRIPTOR_X_GOOGLE_LABEL "x-google-label"
gpointer contacts_utils_get_first (GType t_type,
                                   GBoxedCopyFunc t_dup_func,
                                   GDestroyNotify t_destroy_func,
                                   GeeCollection* collection);
gboolean contacts_vcard_type_mapping_matches (ContactsVcardTypeMapping *self,
                                              GeeCollection* types);
void contacts_typeset_set_category (ContactsTypeSet* self,
                                    const gchar* value);
ContactsTypeSet* contacts_typeset_get_general (void);
ContactsTypeSet* contacts_typeset_get_email (void);
ContactsTypeSet* contacts_typeset_get_phone (void);
static void contacts_typeset_finalize (GObject * obj);
static GType contacts_typeset_get_type_once (void);
static void _vala_contacts_typeset_get_property (GObject * object,
                                          guint property_id,
                                          GValue * value,
                                          GParamSpec * pspec);
static void _vala_contacts_typeset_set_property (GObject * object,
                                          guint property_id,
                                          const GValue * value,
                                          GParamSpec * pspec);

static const ContactsVcardTypeMapping CONTACTS_TYPESET_general_data[2] = {{N_ ("Home"), {"HOME"}}, {N_ ("Work"), {"WORK"}}};
static const ContactsVcardTypeMapping CONTACTS_TYPESET_email_data[3] = {{N_ ("Personal"), {"PERSONAL"}}, {N_ ("Home"), {"HOME"}}, {N_ ("Work"), {"WORK"}}};
static const ContactsVcardTypeMapping CONTACTS_TYPESET_phone_data[18] = {{N_ ("Assistant"), {"X-EVOLUTION-ASSISTANT"}}, {N_ ("Work"), {"WORK", "VOICE"}}, {N_ ("Work Fax"), {"WORK", "FAX"}}, {N_ ("Work"), {"WORK"}}, {N_ ("Callback"), {"X-EVOLUTION-CALLBACK"}}, {N_ ("Car"), {"CAR"}}, {N_ ("Company"), {"X-EVOLUTION-COMPANY"}}, {N_ ("Home"), {"HOME", "VOICE"}}, {N_ ("Home Fax"), {"HOME", "FAX"}}, {N_ ("Home"), {"HOME"}}, {N_ ("ISDN"), {"ISDN"}}, {N_ ("Mobile"), {"CELL"}}, {N_ ("Other"), {"VOICE"}}, {N_ ("Fax"), {"FAX"}}, {N_ ("Pager"), {"PAGER"}}, {N_ ("Radio"), {"X-EVOLUTION-RADIO"}}, {N_ ("Telex"), {"X-EVOLUTION-TELEX"}}, {N_ ("TTY"), {"X-EVOLUTION-TTYTDD"}}};

static inline gpointer
contacts_typeset_get_instance_private (ContactsTypeSet* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsTypeSet_private_offset);
}

/**
   * Creates a TypeSet for the given category, e.g. "phones" (used for debugging)
   */
static ContactsTypeSet*
contacts_typeset_construct (GType object_type,
                            const gchar* category)
{
	ContactsTypeSet * self = NULL;
	GtkListStore* _tmp0_;
	GtkListStore* _tmp1_;
#line 48 "../src/contacts-typeset.vala"
	self = (ContactsTypeSet*) g_object_new (object_type, "category", category, NULL);
#line 50 "../src/contacts-typeset.vala"
	_tmp0_ = gtk_list_store_new (2, G_TYPE_STRING, CONTACTS_TYPE_TYPEDESCRIPTOR, -1);
#line 50 "../src/contacts-typeset.vala"
	_tmp1_ = _tmp0_;
#line 50 "../src/contacts-typeset.vala"
	contacts_typeset_set_store (self, _tmp1_);
#line 50 "../src/contacts-typeset.vala"
	_g_object_unref0 (_tmp1_);
#line 47 "../src/contacts-typeset.vala"
	return self;
#line 221 "contacts-typeset.c"
}

static ContactsTypeSet*
contacts_typeset_new (const gchar* category)
{
#line 47 "../src/contacts-typeset.vala"
	return contacts_typeset_construct (CONTACTS_TYPE_TYPESET, category);
#line 229 "contacts-typeset.c"
}

/**
   * Returns the TreeIter which corresponds to the type of the given
   * AbstractFieldDetails.
   */
void
contacts_typeset_get_iter_for_field_details (ContactsTypeSet* self,
                                             FolksAbstractFieldDetails* detail,
                                             GtkTreeIter* iter)
{
	GtkTreeIter _vala_iter = {0};
	ContactsTypeDescriptor* d = NULL;
	ContactsTypeDescriptor* _tmp0_;
	GtkTreeIter _tmp1_;
#line 57 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 57 "../src/contacts-typeset.vala"
	g_return_if_fail (detail != NULL);
#line 59 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset_lookup_descriptor_for_field_details (self, detail);
#line 59 "../src/contacts-typeset.vala"
	d = _tmp0_;
#line 60 "../src/contacts-typeset.vala"
	_tmp1_ = d->iter;
#line 60 "../src/contacts-typeset.vala"
	_vala_iter = _tmp1_;
#line 57 "../src/contacts-typeset.vala"
	_g_object_unref0 (d);
#line 57 "../src/contacts-typeset.vala"
	if (iter) {
#line 57 "../src/contacts-typeset.vala"
		*iter = _vala_iter;
#line 263 "contacts-typeset.c"
	}
}

/**
   * Returns the TreeIter which corresponds the best to the given vcard type.
   * @param type A VCard-like type, such as "HOME" or "CELL".
   */
void
contacts_typeset_get_iter_for_vcard_type (ContactsTypeSet* self,
                                          const gchar* type,
                                          GtkTreeIter* iter)
{
	GtkTreeIter _vala_iter = {0};
	ContactsTypeDescriptor* d = NULL;
	ContactsTypeDescriptor* _tmp0_;
	GtkTreeIter _tmp1_ = {0};
	ContactsTypeDescriptor* _tmp2_;
#line 67 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 67 "../src/contacts-typeset.vala"
	g_return_if_fail (type != NULL);
#line 68 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset_lookup_descriptor_by_vcard_type (self, type);
#line 68 "../src/contacts-typeset.vala"
	d = _tmp0_;
#line 69 "../src/contacts-typeset.vala"
	_tmp2_ = d;
#line 69 "../src/contacts-typeset.vala"
	if (_tmp2_ != NULL) {
#line 293 "contacts-typeset.c"
		ContactsTypeDescriptor* _tmp3_;
		GtkTreeIter _tmp4_;
#line 69 "../src/contacts-typeset.vala"
		_tmp3_ = d;
#line 69 "../src/contacts-typeset.vala"
		_tmp4_ = _tmp3_->iter;
#line 69 "../src/contacts-typeset.vala"
		_tmp1_ = _tmp4_;
#line 302 "contacts-typeset.c"
	} else {
		ContactsTypeDescriptor* _tmp5_;
		GtkTreeIter _tmp6_;
#line 69 "../src/contacts-typeset.vala"
		_tmp5_ = self->priv->other_dummy;
#line 69 "../src/contacts-typeset.vala"
		_tmp6_ = _tmp5_->iter;
#line 69 "../src/contacts-typeset.vala"
		_tmp1_ = _tmp6_;
#line 312 "contacts-typeset.c"
	}
#line 69 "../src/contacts-typeset.vala"
	_vala_iter = _tmp1_;
#line 67 "../src/contacts-typeset.vala"
	if (iter) {
#line 67 "../src/contacts-typeset.vala"
		*iter = _vala_iter;
#line 320 "contacts-typeset.c"
	}
}

/**
   * Returns the TreeIter which corresponds the best to the given custom label.
   */
static gpointer
_g_object_ref0 (gpointer self)
{
#line 76 "../src/contacts-typeset.vala"
	return self ? g_object_ref (self) : NULL;
#line 332 "contacts-typeset.c"
}

void
contacts_typeset_get_iter_for_custom_label (ContactsTypeSet* self,
                                            const gchar* label,
                                            GtkTreeIter* iter)
{
	GtkTreeIter _vala_iter = {0};
	ContactsTypeDescriptor* descr = NULL;
	ContactsTypeDescriptor* _tmp0_;
	ContactsTypeDescriptor* _tmp1_;
	ContactsTypeDescriptor* _tmp2_;
	ContactsTypeDescriptor* _tmp4_;
	GtkTreeIter _tmp5_;
#line 75 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 75 "../src/contacts-typeset.vala"
	g_return_if_fail (label != NULL);
#line 76 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset_get_descriptor_for_custom_label (self, label);
#line 76 "../src/contacts-typeset.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 76 "../src/contacts-typeset.vala"
	descr = _tmp1_;
#line 77 "../src/contacts-typeset.vala"
	_tmp2_ = descr;
#line 77 "../src/contacts-typeset.vala"
	if (_tmp2_ == NULL) {
#line 361 "contacts-typeset.c"
		ContactsTypeDescriptor* _tmp3_;
#line 78 "../src/contacts-typeset.vala"
		_tmp3_ = contacts_typeset_create_descriptor_for_custom_label (self, label);
#line 78 "../src/contacts-typeset.vala"
		_g_object_unref0 (descr);
#line 78 "../src/contacts-typeset.vala"
		descr = _tmp3_;
#line 369 "contacts-typeset.c"
	}
#line 79 "../src/contacts-typeset.vala"
	_tmp4_ = descr;
#line 79 "../src/contacts-typeset.vala"
	_tmp5_ = _tmp4_->iter;
#line 79 "../src/contacts-typeset.vala"
	_vala_iter = _tmp5_;
#line 75 "../src/contacts-typeset.vala"
	_g_object_unref0 (descr);
#line 75 "../src/contacts-typeset.vala"
	if (iter) {
#line 75 "../src/contacts-typeset.vala"
		*iter = _vala_iter;
#line 383 "contacts-typeset.c"
	}
}

/**
   * Returns the display name for the type of the given AbstractFieldDetails.
   */
gchar*
contacts_typeset_format_type (ContactsTypeSet* self,
                              FolksAbstractFieldDetails* detail)
{
	ContactsTypeDescriptor* d = NULL;
	ContactsTypeDescriptor* _tmp0_;
	const gchar* _tmp1_;
	const gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* result = NULL;
#line 85 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 85 "../src/contacts-typeset.vala"
	g_return_val_if_fail (detail != NULL, NULL);
#line 86 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset_lookup_descriptor_for_field_details (self, detail);
#line 86 "../src/contacts-typeset.vala"
	d = _tmp0_;
#line 87 "../src/contacts-typeset.vala"
	_tmp1_ = contacts_typedescriptor_get_display_name (d);
#line 87 "../src/contacts-typeset.vala"
	_tmp2_ = _tmp1_;
#line 87 "../src/contacts-typeset.vala"
	_tmp3_ = g_strdup (_tmp2_);
#line 87 "../src/contacts-typeset.vala"
	result = _tmp3_;
#line 87 "../src/contacts-typeset.vala"
	_g_object_unref0 (d);
#line 87 "../src/contacts-typeset.vala"
	return result;
#line 420 "contacts-typeset.c"
}

/**
   * Adds the TypeDescriptor to the {@link TypeSet}'s store.
   * @param descriptor The TypeDescription to be added
   */
static void
contacts_typeset_add_descriptor_to_store (ContactsTypeSet* self,
                                          ContactsTypeDescriptor* descriptor)
{
	const gchar* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	GtkListStore* _tmp7_;
	GtkTreeIter _tmp8_;
	const gchar* _tmp9_;
	const gchar* _tmp10_;
#line 94 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 94 "../src/contacts-typeset.vala"
	g_return_if_fail (descriptor != NULL);
#line 95 "../src/contacts-typeset.vala"
	_tmp0_ = self->priv->_category;
#line 95 "../src/contacts-typeset.vala"
	_tmp1_ = contacts_typedescriptor_to_string (descriptor);
#line 95 "../src/contacts-typeset.vala"
	_tmp2_ = _tmp1_;
#line 95 "../src/contacts-typeset.vala"
	g_debug ("contacts-typeset.vala:95: %s: Adding type %s to store", _tmp0_, _tmp2_);
#line 95 "../src/contacts-typeset.vala"
	_g_free0 (_tmp2_);
#line 97 "../src/contacts-typeset.vala"
	if (contacts_typedescriptor_is_custom (descriptor)) {
#line 454 "contacts-typeset.c"
		GtkListStore* _tmp3_;
		GtkTreeIter _tmp4_ = {0};
#line 98 "../src/contacts-typeset.vala"
		_tmp3_ = self->priv->_store;
#line 98 "../src/contacts-typeset.vala"
		gtk_list_store_insert_before (_tmp3_, &_tmp4_, NULL);
#line 98 "../src/contacts-typeset.vala"
		descriptor->iter = _tmp4_;
#line 463 "contacts-typeset.c"
	} else {
		GtkListStore* _tmp5_;
		GtkTreeIter _tmp6_ = {0};
#line 100 "../src/contacts-typeset.vala"
		_tmp5_ = self->priv->_store;
#line 100 "../src/contacts-typeset.vala"
		gtk_list_store_append (_tmp5_, &_tmp6_);
#line 100 "../src/contacts-typeset.vala"
		descriptor->iter = _tmp6_;
#line 473 "contacts-typeset.c"
	}
#line 102 "../src/contacts-typeset.vala"
	_tmp7_ = self->priv->_store;
#line 102 "../src/contacts-typeset.vala"
	_tmp8_ = descriptor->iter;
#line 102 "../src/contacts-typeset.vala"
	_tmp9_ = contacts_typedescriptor_get_display_name (descriptor);
#line 102 "../src/contacts-typeset.vala"
	_tmp10_ = _tmp9_;
#line 102 "../src/contacts-typeset.vala"
	gtk_list_store_set (_tmp7_, &_tmp8_, 0, _tmp10_, 1, descriptor, -1);
#line 485 "contacts-typeset.c"
}

/**
   * Returns the TypeDescriptor for the given display name in the
   * {@link TypeSet}'s store, if any.
   *
   * @param display_name The translated display name
   * @return The appropriate TypeDescriptor or null if no match was found.
   */
ContactsTypeDescriptor*
contacts_typeset_lookup_descriptor_in_store (ContactsTypeSet* self,
                                             const gchar* display_name)
{
	GtkTreeIter iter = {0};
	GtkListStore* _tmp0_;
	GtkTreeIter _tmp1_ = {0};
	gboolean _tmp2_;
	ContactsTypeDescriptor* result = NULL;
#line 112 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 112 "../src/contacts-typeset.vala"
	g_return_val_if_fail (display_name != NULL, NULL);
#line 116 "../src/contacts-typeset.vala"
	_tmp0_ = self->priv->_store;
#line 116 "../src/contacts-typeset.vala"
	_tmp2_ = gtk_tree_model_get_iter_first ((GtkTreeModel*) _tmp0_, &_tmp1_);
#line 116 "../src/contacts-typeset.vala"
	iter = _tmp1_;
#line 116 "../src/contacts-typeset.vala"
	if (!_tmp2_) {
#line 117 "../src/contacts-typeset.vala"
		result = NULL;
#line 117 "../src/contacts-typeset.vala"
		return result;
#line 520 "contacts-typeset.c"
	}
	{
		gboolean _tmp3_ = FALSE;
#line 119 "../src/contacts-typeset.vala"
		_tmp3_ = TRUE;
#line 119 "../src/contacts-typeset.vala"
		while (TRUE) {
#line 528 "contacts-typeset.c"
			ContactsTypeDescriptor* type_descr = NULL;
			GtkListStore* _tmp6_;
			GtkTreeIter _tmp7_;
			ContactsTypeDescriptor* _tmp8_ = NULL;
			ContactsTypeDescriptor* _tmp9_;
			const gchar* _tmp10_;
			const gchar* _tmp11_;
			ContactsTypeDescriptor* _tmp13_;
			const gchar* _tmp14_;
#line 119 "../src/contacts-typeset.vala"
			if (!_tmp3_) {
#line 540 "contacts-typeset.c"
				GtkListStore* _tmp4_;
				gboolean _tmp5_;
#line 127 "../src/contacts-typeset.vala"
				_tmp4_ = self->priv->_store;
#line 127 "../src/contacts-typeset.vala"
				_tmp5_ = gtk_tree_model_iter_next ((GtkTreeModel*) _tmp4_, &iter);
#line 127 "../src/contacts-typeset.vala"
				if (!_tmp5_) {
#line 127 "../src/contacts-typeset.vala"
					break;
#line 551 "contacts-typeset.c"
				}
			}
#line 119 "../src/contacts-typeset.vala"
			_tmp3_ = FALSE;
#line 121 "../src/contacts-typeset.vala"
			_tmp6_ = self->priv->_store;
#line 121 "../src/contacts-typeset.vala"
			_tmp7_ = iter;
#line 121 "../src/contacts-typeset.vala"
			gtk_tree_model_get ((GtkTreeModel*) _tmp6_, &_tmp7_, 1, &_tmp8_, -1);
#line 121 "../src/contacts-typeset.vala"
			type_descr = _tmp8_;
#line 123 "../src/contacts-typeset.vala"
			_tmp9_ = type_descr;
#line 123 "../src/contacts-typeset.vala"
			_tmp10_ = contacts_typedescriptor_get_display_name (_tmp9_);
#line 123 "../src/contacts-typeset.vala"
			_tmp11_ = _tmp10_;
#line 123 "../src/contacts-typeset.vala"
			if (g_ascii_strcasecmp (display_name, _tmp11_) == 0) {
#line 572 "contacts-typeset.c"
				ContactsTypeDescriptor* _tmp12_;
#line 124 "../src/contacts-typeset.vala"
				_tmp12_ = type_descr;
#line 124 "../src/contacts-typeset.vala"
				result = _tmp12_;
#line 124 "../src/contacts-typeset.vala"
				return result;
#line 580 "contacts-typeset.c"
			}
#line 125 "../src/contacts-typeset.vala"
			_tmp13_ = type_descr;
#line 125 "../src/contacts-typeset.vala"
			_tmp14_ = _tmp13_->name;
#line 125 "../src/contacts-typeset.vala"
			if (g_ascii_strcasecmp (display_name, _tmp14_) == 0) {
#line 588 "contacts-typeset.c"
				ContactsTypeDescriptor* _tmp15_;
#line 126 "../src/contacts-typeset.vala"
				_tmp15_ = type_descr;
#line 126 "../src/contacts-typeset.vala"
				result = _tmp15_;
#line 126 "../src/contacts-typeset.vala"
				return result;
#line 596 "contacts-typeset.c"
			}
		}
	}
#line 130 "../src/contacts-typeset.vala"
	result = NULL;
#line 130 "../src/contacts-typeset.vala"
	return result;
#line 604 "contacts-typeset.c"
}

static void
contacts_typeset_add_vcard_mapping (ContactsTypeSet* self,
                                    ContactsVcardTypeMapping* vcard_mapping)
{
	ContactsTypeDescriptor* descriptor = NULL;
	ContactsVcardTypeMapping _tmp0_;
	const gchar* _tmp1_;
	ContactsTypeDescriptor* _tmp2_;
	ContactsTypeDescriptor* _tmp3_;
	ContactsTypeDescriptor* _tmp4_;
	GeeList* _tmp10_;
	ContactsVcardTypeMapping _tmp11_;
#line 133 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 133 "../src/contacts-typeset.vala"
	g_return_if_fail (vcard_mapping != NULL);
#line 134 "../src/contacts-typeset.vala"
	_tmp0_ = *vcard_mapping;
#line 134 "../src/contacts-typeset.vala"
	_tmp1_ = _tmp0_.name;
#line 134 "../src/contacts-typeset.vala"
	_tmp2_ = contacts_typeset_lookup_descriptor_in_store (self, _tmp1_);
#line 134 "../src/contacts-typeset.vala"
	_tmp3_ = _g_object_ref0 (_tmp2_);
#line 134 "../src/contacts-typeset.vala"
	descriptor = _tmp3_;
#line 135 "../src/contacts-typeset.vala"
	_tmp4_ = descriptor;
#line 135 "../src/contacts-typeset.vala"
	if (_tmp4_ == NULL) {
#line 637 "contacts-typeset.c"
		ContactsVcardTypeMapping _tmp5_;
		const gchar* _tmp6_;
		ContactsVcardTypeMapping _tmp7_;
		ContactsTypeDescriptor* _tmp8_;
		ContactsTypeDescriptor* _tmp9_;
#line 136 "../src/contacts-typeset.vala"
		_tmp5_ = *vcard_mapping;
#line 136 "../src/contacts-typeset.vala"
		_tmp6_ = _tmp5_.name;
#line 136 "../src/contacts-typeset.vala"
		_tmp7_ = *vcard_mapping;
#line 136 "../src/contacts-typeset.vala"
		_tmp8_ = contacts_typedescriptor_new_vcard (_tmp6_, _tmp7_.types, 3);
#line 136 "../src/contacts-typeset.vala"
		_g_object_unref0 (descriptor);
#line 136 "../src/contacts-typeset.vala"
		descriptor = _tmp8_;
#line 137 "../src/contacts-typeset.vala"
		_tmp9_ = descriptor;
#line 137 "../src/contacts-typeset.vala"
		contacts_typeset_add_descriptor_to_store (self, _tmp9_);
#line 659 "contacts-typeset.c"
	}
#line 140 "../src/contacts-typeset.vala"
	_tmp10_ = self->priv->vcard_type_mappings;
#line 140 "../src/contacts-typeset.vala"
	_tmp11_ = *vcard_mapping;
#line 140 "../src/contacts-typeset.vala"
	gee_collection_add ((GeeCollection*) _tmp10_, &_tmp11_);
#line 133 "../src/contacts-typeset.vala"
	_g_object_unref0 (descriptor);
#line 669 "contacts-typeset.c"
}

static void
contacts_typeset_add_type_other (ContactsTypeSet* self)
{
	GtkListStore* _tmp0_;
	ContactsTypeDescriptor* _tmp1_;
	GtkTreeIter _tmp2_ = {0};
	GtkListStore* _tmp3_;
	ContactsTypeDescriptor* _tmp4_;
	GtkTreeIter _tmp5_;
	ContactsTypeDescriptor* _tmp6_;
	const gchar* _tmp7_;
	const gchar* _tmp8_;
	ContactsTypeDescriptor* _tmp9_;
#line 144 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 145 "../src/contacts-typeset.vala"
	_tmp0_ = self->priv->_store;
#line 145 "../src/contacts-typeset.vala"
	_tmp1_ = self->priv->other_dummy;
#line 145 "../src/contacts-typeset.vala"
	gtk_list_store_append (_tmp0_, &_tmp2_);
#line 145 "../src/contacts-typeset.vala"
	_tmp1_->iter = _tmp2_;
#line 146 "../src/contacts-typeset.vala"
	_tmp3_ = self->priv->_store;
#line 146 "../src/contacts-typeset.vala"
	_tmp4_ = self->priv->other_dummy;
#line 146 "../src/contacts-typeset.vala"
	_tmp5_ = _tmp4_->iter;
#line 146 "../src/contacts-typeset.vala"
	_tmp6_ = self->priv->other_dummy;
#line 146 "../src/contacts-typeset.vala"
	_tmp7_ = contacts_typedescriptor_get_display_name (_tmp6_);
#line 146 "../src/contacts-typeset.vala"
	_tmp8_ = _tmp7_;
#line 146 "../src/contacts-typeset.vala"
	_tmp9_ = self->priv->other_dummy;
#line 146 "../src/contacts-typeset.vala"
	gtk_list_store_set (_tmp3_, &_tmp5_, 0, _tmp8_, 1, _tmp9_, -1);
#line 711 "contacts-typeset.c"
}

/**
   * Tries to find the TypeDescriptor matching the given custom label, or null if none.
   */
ContactsTypeDescriptor*
contacts_typeset_get_descriptor_for_custom_label (ContactsTypeSet* self,
                                                  const gchar* label)
{
	ContactsTypeDescriptor* descriptor = NULL;
	ContactsTypeDescriptor* _tmp0_;
	ContactsTypeDescriptor* _tmp1_;
	ContactsTypeDescriptor* _tmp3_;
	ContactsTypeDescriptor* _tmp4_;
	ContactsTypeDescriptor* result = NULL;
#line 152 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 152 "../src/contacts-typeset.vala"
	g_return_val_if_fail (label != NULL, NULL);
#line 154 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset_lookup_descriptor_in_store (self, label);
#line 154 "../src/contacts-typeset.vala"
	descriptor = _tmp0_;
#line 155 "../src/contacts-typeset.vala"
	_tmp1_ = descriptor;
#line 155 "../src/contacts-typeset.vala"
	if (_tmp1_ != NULL) {
#line 739 "contacts-typeset.c"
		ContactsTypeDescriptor* _tmp2_;
#line 156 "../src/contacts-typeset.vala"
		_tmp2_ = descriptor;
#line 156 "../src/contacts-typeset.vala"
		result = _tmp2_;
#line 156 "../src/contacts-typeset.vala"
		return result;
#line 747 "contacts-typeset.c"
	}
#line 159 "../src/contacts-typeset.vala"
	_tmp3_ = contacts_typeset_lookup_descriptor_by_vcard_type (self, label);
#line 159 "../src/contacts-typeset.vala"
	descriptor = _tmp3_;
#line 160 "../src/contacts-typeset.vala"
	_tmp4_ = descriptor;
#line 160 "../src/contacts-typeset.vala"
	result = _tmp4_;
#line 160 "../src/contacts-typeset.vala"
	return result;
#line 759 "contacts-typeset.c"
}

static ContactsTypeDescriptor*
contacts_typeset_create_descriptor_for_custom_label (ContactsTypeSet* self,
                                                     const gchar* label)
{
	ContactsTypeDescriptor* new_descriptor = NULL;
	ContactsTypeDescriptor* _tmp0_;
	ContactsTypeDescriptor* result = NULL;
#line 163 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 163 "../src/contacts-typeset.vala"
	g_return_val_if_fail (label != NULL, NULL);
#line 164 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typedescriptor_new_custom (label);
#line 164 "../src/contacts-typeset.vala"
	new_descriptor = _tmp0_;
#line 165 "../src/contacts-typeset.vala"
	contacts_typeset_add_descriptor_to_store (self, new_descriptor);
#line 166 "../src/contacts-typeset.vala"
	result = new_descriptor;
#line 166 "../src/contacts-typeset.vala"
	return result;
#line 783 "contacts-typeset.c"
}

/**
   * Returns the TypeDescriptor which corresponds the best to the given vcard type.
   * @param str A VCard-like type, such as "HOME" or "CELL".
   */
static ContactsTypeDescriptor*
contacts_typeset_lookup_descriptor_by_vcard_type (ContactsTypeSet* self,
                                                  const gchar* str)
{
	ContactsTypeDescriptor* result = NULL;
#line 173 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 173 "../src/contacts-typeset.vala"
	g_return_val_if_fail (str != NULL, NULL);
#line 799 "contacts-typeset.c"
	{
		GeeList* _mapping_list = NULL;
		GeeList* _tmp0_;
		GeeList* _tmp1_;
		gint _mapping_size = 0;
		GeeList* _tmp2_;
		gint _tmp3_;
		gint _tmp4_;
		gint _mapping_index = 0;
#line 174 "../src/contacts-typeset.vala"
		_tmp0_ = self->priv->vcard_type_mappings;
#line 174 "../src/contacts-typeset.vala"
		_tmp1_ = _g_object_ref0 (_tmp0_);
#line 174 "../src/contacts-typeset.vala"
		_mapping_list = _tmp1_;
#line 174 "../src/contacts-typeset.vala"
		_tmp2_ = _mapping_list;
#line 174 "../src/contacts-typeset.vala"
		_tmp3_ = gee_collection_get_size ((GeeCollection*) _tmp2_);
#line 174 "../src/contacts-typeset.vala"
		_tmp4_ = _tmp3_;
#line 174 "../src/contacts-typeset.vala"
		_mapping_size = _tmp4_;
#line 174 "../src/contacts-typeset.vala"
		_mapping_index = -1;
#line 174 "../src/contacts-typeset.vala"
		while (TRUE) {
#line 827 "contacts-typeset.c"
			ContactsVcardTypeMapping* mapping = NULL;
			GeeList* _tmp5_;
			gpointer _tmp6_;
			ContactsVcardTypeMapping* _tmp7_;
#line 174 "../src/contacts-typeset.vala"
			_mapping_index = _mapping_index + 1;
#line 174 "../src/contacts-typeset.vala"
			if (!(_mapping_index < _mapping_size)) {
#line 174 "../src/contacts-typeset.vala"
				break;
#line 838 "contacts-typeset.c"
			}
#line 174 "../src/contacts-typeset.vala"
			_tmp5_ = _mapping_list;
#line 174 "../src/contacts-typeset.vala"
			_tmp6_ = gee_list_get (_tmp5_, _mapping_index);
#line 174 "../src/contacts-typeset.vala"
			mapping = (ContactsVcardTypeMapping*) _tmp6_;
#line 175 "../src/contacts-typeset.vala"
			_tmp7_ = mapping;
#line 175 "../src/contacts-typeset.vala"
			if (contacts_vcard_type_mapping_contains (_tmp7_, str)) {
#line 850 "contacts-typeset.c"
				ContactsVcardTypeMapping* _tmp8_;
				const gchar* _tmp9_;
				ContactsTypeDescriptor* _tmp10_;
#line 176 "../src/contacts-typeset.vala"
				_tmp8_ = mapping;
#line 176 "../src/contacts-typeset.vala"
				_tmp9_ = (*_tmp8_).name;
#line 176 "../src/contacts-typeset.vala"
				_tmp10_ = contacts_typeset_lookup_descriptor_in_store (self, _tmp9_);
#line 176 "../src/contacts-typeset.vala"
				result = _tmp10_;
#line 176 "../src/contacts-typeset.vala"
				_contacts_vcard_type_mapping_free0 (mapping);
#line 176 "../src/contacts-typeset.vala"
				_g_object_unref0 (_mapping_list);
#line 176 "../src/contacts-typeset.vala"
				return result;
#line 868 "contacts-typeset.c"
			}
#line 174 "../src/contacts-typeset.vala"
			_contacts_vcard_type_mapping_free0 (mapping);
#line 872 "contacts-typeset.c"
		}
#line 174 "../src/contacts-typeset.vala"
		_g_object_unref0 (_mapping_list);
#line 876 "contacts-typeset.c"
	}
#line 179 "../src/contacts-typeset.vala"
	result = NULL;
#line 179 "../src/contacts-typeset.vala"
	return result;
#line 882 "contacts-typeset.c"
}

ContactsTypeDescriptor*
contacts_typeset_lookup_descriptor_for_field_details (ContactsTypeSet* self,
                                                      FolksAbstractFieldDetails* detail)
{
	GeeMultiMap* _tmp0_;
	GeeMultiMap* _tmp1_;
	GeeCollection* types = NULL;
	GeeCollection* _tmp14_;
	gboolean _tmp15_ = FALSE;
	GeeCollection* _tmp16_;
	ContactsTypeDescriptor* _tmp35_;
	ContactsTypeDescriptor* _tmp36_;
	ContactsTypeDescriptor* result = NULL;
#line 182 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 182 "../src/contacts-typeset.vala"
	g_return_val_if_fail (detail != NULL, NULL);
#line 183 "../src/contacts-typeset.vala"
	_tmp0_ = folks_abstract_field_details_get_parameters (detail);
#line 183 "../src/contacts-typeset.vala"
	_tmp1_ = _tmp0_;
#line 183 "../src/contacts-typeset.vala"
	if (gee_multi_map_contains (_tmp1_, CONTACTS_TYPEDESCRIPTOR_X_GOOGLE_LABEL)) {
#line 908 "contacts-typeset.c"
		gchar* label = NULL;
		GeeMultiMap* _tmp2_;
		GeeMultiMap* _tmp3_;
		GeeCollection* _tmp4_;
		GeeCollection* _tmp5_;
		gpointer _tmp6_;
		gchar* _tmp7_;
		ContactsTypeDescriptor* descriptor = NULL;
		const gchar* _tmp8_;
		ContactsTypeDescriptor* _tmp9_;
		ContactsTypeDescriptor* _tmp10_;
		ContactsTypeDescriptor* _tmp11_;
#line 184 "../src/contacts-typeset.vala"
		_tmp2_ = folks_abstract_field_details_get_parameters (detail);
#line 184 "../src/contacts-typeset.vala"
		_tmp3_ = _tmp2_;
#line 184 "../src/contacts-typeset.vala"
		_tmp4_ = gee_multi_map_get (_tmp3_, CONTACTS_TYPEDESCRIPTOR_X_GOOGLE_LABEL);
#line 184 "../src/contacts-typeset.vala"
		_tmp5_ = _tmp4_;
#line 184 "../src/contacts-typeset.vala"
		_tmp6_ = contacts_utils_get_first (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, _tmp5_);
#line 184 "../src/contacts-typeset.vala"
		_tmp7_ = (gchar*) _tmp6_;
#line 184 "../src/contacts-typeset.vala"
		_g_object_unref0 (_tmp5_);
#line 184 "../src/contacts-typeset.vala"
		label = _tmp7_;
#line 185 "../src/contacts-typeset.vala"
		_tmp8_ = label;
#line 185 "../src/contacts-typeset.vala"
		_tmp9_ = contacts_typeset_get_descriptor_for_custom_label (self, _tmp8_);
#line 185 "../src/contacts-typeset.vala"
		_tmp10_ = _g_object_ref0 (_tmp9_);
#line 185 "../src/contacts-typeset.vala"
		descriptor = _tmp10_;
#line 187 "../src/contacts-typeset.vala"
		_tmp11_ = descriptor;
#line 187 "../src/contacts-typeset.vala"
		if (_tmp11_ == NULL) {
#line 949 "contacts-typeset.c"
			const gchar* _tmp12_;
			ContactsTypeDescriptor* _tmp13_;
#line 188 "../src/contacts-typeset.vala"
			_tmp12_ = label;
#line 188 "../src/contacts-typeset.vala"
			_tmp13_ = contacts_typeset_create_descriptor_for_custom_label (self, _tmp12_);
#line 188 "../src/contacts-typeset.vala"
			_g_object_unref0 (descriptor);
#line 188 "../src/contacts-typeset.vala"
			descriptor = _tmp13_;
#line 960 "contacts-typeset.c"
		}
#line 189 "../src/contacts-typeset.vala"
		result = descriptor;
#line 189 "../src/contacts-typeset.vala"
		_g_free0 (label);
#line 189 "../src/contacts-typeset.vala"
		return result;
#line 968 "contacts-typeset.c"
	}
#line 192 "../src/contacts-typeset.vala"
	_tmp14_ = folks_abstract_field_details_get_parameter_values (detail, "type");
#line 192 "../src/contacts-typeset.vala"
	types = _tmp14_;
#line 193 "../src/contacts-typeset.vala"
	_tmp16_ = types;
#line 193 "../src/contacts-typeset.vala"
	if (_tmp16_ == NULL) {
#line 193 "../src/contacts-typeset.vala"
		_tmp15_ = TRUE;
#line 980 "contacts-typeset.c"
	} else {
		GeeCollection* _tmp17_;
		gboolean _tmp18_;
		gboolean _tmp19_;
#line 193 "../src/contacts-typeset.vala"
		_tmp17_ = types;
#line 193 "../src/contacts-typeset.vala"
		_tmp18_ = gee_collection_get_is_empty (_tmp17_);
#line 193 "../src/contacts-typeset.vala"
		_tmp19_ = _tmp18_;
#line 193 "../src/contacts-typeset.vala"
		_tmp15_ = _tmp19_;
#line 993 "contacts-typeset.c"
	}
#line 193 "../src/contacts-typeset.vala"
	if (_tmp15_) {
#line 997 "contacts-typeset.c"
		ContactsTypeDescriptor* _tmp20_;
		ContactsTypeDescriptor* _tmp21_;
#line 194 "../src/contacts-typeset.vala"
		g_warning ("contacts-typeset.vala:194: No types given in the AbstractFieldDetails");
#line 195 "../src/contacts-typeset.vala"
		_tmp20_ = self->priv->other_dummy;
#line 195 "../src/contacts-typeset.vala"
		_tmp21_ = _g_object_ref0 (_tmp20_);
#line 195 "../src/contacts-typeset.vala"
		result = _tmp21_;
#line 195 "../src/contacts-typeset.vala"
		_g_object_unref0 (types);
#line 195 "../src/contacts-typeset.vala"
		return result;
#line 1012 "contacts-typeset.c"
	}
	{
		GeeList* _d_list = NULL;
		GeeList* _tmp22_;
		GeeList* _tmp23_;
		gint _d_size = 0;
		GeeList* _tmp24_;
		gint _tmp25_;
		gint _tmp26_;
		gint _d_index = 0;
#line 198 "../src/contacts-typeset.vala"
		_tmp22_ = self->priv->vcard_type_mappings;
#line 198 "../src/contacts-typeset.vala"
		_tmp23_ = _g_object_ref0 (_tmp22_);
#line 198 "../src/contacts-typeset.vala"
		_d_list = _tmp23_;
#line 198 "../src/contacts-typeset.vala"
		_tmp24_ = _d_list;
#line 198 "../src/contacts-typeset.vala"
		_tmp25_ = gee_collection_get_size ((GeeCollection*) _tmp24_);
#line 198 "../src/contacts-typeset.vala"
		_tmp26_ = _tmp25_;
#line 198 "../src/contacts-typeset.vala"
		_d_size = _tmp26_;
#line 198 "../src/contacts-typeset.vala"
		_d_index = -1;
#line 198 "../src/contacts-typeset.vala"
		while (TRUE) {
#line 1041 "contacts-typeset.c"
			ContactsVcardTypeMapping* d = NULL;
			GeeList* _tmp27_;
			gpointer _tmp28_;
			ContactsVcardTypeMapping* _tmp29_;
			GeeCollection* _tmp30_;
#line 198 "../src/contacts-typeset.vala"
			_d_index = _d_index + 1;
#line 198 "../src/contacts-typeset.vala"
			if (!(_d_index < _d_size)) {
#line 198 "../src/contacts-typeset.vala"
				break;
#line 1053 "contacts-typeset.c"
			}
#line 198 "../src/contacts-typeset.vala"
			_tmp27_ = _d_list;
#line 198 "../src/contacts-typeset.vala"
			_tmp28_ = gee_list_get (_tmp27_, _d_index);
#line 198 "../src/contacts-typeset.vala"
			d = (ContactsVcardTypeMapping*) _tmp28_;
#line 199 "../src/contacts-typeset.vala"
			_tmp29_ = d;
#line 199 "../src/contacts-typeset.vala"
			_tmp30_ = types;
#line 199 "../src/contacts-typeset.vala"
			if (contacts_vcard_type_mapping_matches (_tmp29_, _tmp30_)) {
#line 1067 "contacts-typeset.c"
				ContactsVcardTypeMapping* _tmp31_;
				const gchar* _tmp32_;
				ContactsTypeDescriptor* _tmp33_;
				ContactsTypeDescriptor* _tmp34_;
#line 200 "../src/contacts-typeset.vala"
				_tmp31_ = d;
#line 200 "../src/contacts-typeset.vala"
				_tmp32_ = (*_tmp31_).name;
#line 200 "../src/contacts-typeset.vala"
				_tmp33_ = contacts_typeset_lookup_descriptor_in_store (self, _tmp32_);
#line 200 "../src/contacts-typeset.vala"
				_tmp34_ = _g_object_ref0 (_tmp33_);
#line 200 "../src/contacts-typeset.vala"
				result = _tmp34_;
#line 200 "../src/contacts-typeset.vala"
				_contacts_vcard_type_mapping_free0 (d);
#line 200 "../src/contacts-typeset.vala"
				_g_object_unref0 (_d_list);
#line 200 "../src/contacts-typeset.vala"
				_g_object_unref0 (types);
#line 200 "../src/contacts-typeset.vala"
				return result;
#line 1090 "contacts-typeset.c"
			}
#line 198 "../src/contacts-typeset.vala"
			_contacts_vcard_type_mapping_free0 (d);
#line 1094 "contacts-typeset.c"
		}
#line 198 "../src/contacts-typeset.vala"
		_g_object_unref0 (_d_list);
#line 1098 "contacts-typeset.c"
	}
#line 203 "../src/contacts-typeset.vala"
	_tmp35_ = self->priv->other_dummy;
#line 203 "../src/contacts-typeset.vala"
	_tmp36_ = _g_object_ref0 (_tmp35_);
#line 203 "../src/contacts-typeset.vala"
	result = _tmp36_;
#line 203 "../src/contacts-typeset.vala"
	_g_object_unref0 (types);
#line 203 "../src/contacts-typeset.vala"
	return result;
#line 1110 "contacts-typeset.c"
}

const gchar*
contacts_typeset_get_category (ContactsTypeSet* self)
{
	const gchar* result;
	const gchar* _tmp0_;
#line 30 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 30 "../src/contacts-typeset.vala"
	_tmp0_ = self->priv->_category;
#line 30 "../src/contacts-typeset.vala"
	result = _tmp0_;
#line 30 "../src/contacts-typeset.vala"
	return result;
#line 1126 "contacts-typeset.c"
}

void
contacts_typeset_set_category (ContactsTypeSet* self,
                               const gchar* value)
{
#line 30 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 30 "../src/contacts-typeset.vala"
	if (g_strcmp0 (value, contacts_typeset_get_category (self)) != 0) {
#line 1137 "contacts-typeset.c"
		gchar* _tmp0_;
#line 30 "../src/contacts-typeset.vala"
		_tmp0_ = g_strdup (value);
#line 30 "../src/contacts-typeset.vala"
		_g_free0 (self->priv->_category);
#line 30 "../src/contacts-typeset.vala"
		self->priv->_category = _tmp0_;
#line 30 "../src/contacts-typeset.vala"
		g_object_notify_by_pspec ((GObject *) self, contacts_typeset_properties[CONTACTS_TYPESET_CATEGORY_PROPERTY]);
#line 1147 "contacts-typeset.c"
	}
}

GtkListStore*
contacts_typeset_get_store (ContactsTypeSet* self)
{
	GtkListStore* result;
	GtkListStore* _tmp0_;
#line 42 "../src/contacts-typeset.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 42 "../src/contacts-typeset.vala"
	_tmp0_ = self->priv->_store;
#line 42 "../src/contacts-typeset.vala"
	result = _tmp0_;
#line 42 "../src/contacts-typeset.vala"
	return result;
#line 1164 "contacts-typeset.c"
}

static void
contacts_typeset_set_store (ContactsTypeSet* self,
                            GtkListStore* value)
{
#line 42 "../src/contacts-typeset.vala"
	g_return_if_fail (self != NULL);
#line 42 "../src/contacts-typeset.vala"
	if (contacts_typeset_get_store (self) != value) {
#line 1175 "contacts-typeset.c"
		GtkListStore* _tmp0_;
#line 42 "../src/contacts-typeset.vala"
		_tmp0_ = _g_object_ref0 (value);
#line 42 "../src/contacts-typeset.vala"
		_g_object_unref0 (self->priv->_store);
#line 42 "../src/contacts-typeset.vala"
		self->priv->_store = _tmp0_;
#line 42 "../src/contacts-typeset.vala"
		g_object_notify_by_pspec ((GObject *) self, contacts_typeset_properties[CONTACTS_TYPESET_STORE_PROPERTY]);
#line 1185 "contacts-typeset.c"
	}
}

ContactsTypeSet*
contacts_typeset_get_general (void)
{
	ContactsTypeSet* result;
	ContactsTypeSet* _tmp0_;
	ContactsTypeSet* _tmp7_;
#line 215 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset__general;
#line 215 "../src/contacts-typeset.vala"
	if (_tmp0_ == NULL) {
#line 1199 "contacts-typeset.c"
		ContactsTypeSet* _tmp1_;
		ContactsTypeSet* _tmp6_;
#line 216 "../src/contacts-typeset.vala"
		_tmp1_ = contacts_typeset_new ("General");
#line 216 "../src/contacts-typeset.vala"
		_g_object_unref0 (contacts_typeset__general);
#line 216 "../src/contacts-typeset.vala"
		contacts_typeset__general = _tmp1_;
#line 1208 "contacts-typeset.c"
		{
			gint i = 0;
#line 217 "../src/contacts-typeset.vala"
			i = 0;
#line 1213 "contacts-typeset.c"
			{
				gboolean _tmp2_ = FALSE;
#line 217 "../src/contacts-typeset.vala"
				_tmp2_ = TRUE;
#line 217 "../src/contacts-typeset.vala"
				while (TRUE) {
#line 1220 "contacts-typeset.c"
					ContactsTypeSet* _tmp4_;
					ContactsVcardTypeMapping _tmp5_;
#line 217 "../src/contacts-typeset.vala"
					if (!_tmp2_) {
#line 1225 "contacts-typeset.c"
						gint _tmp3_;
#line 217 "../src/contacts-typeset.vala"
						_tmp3_ = i;
#line 217 "../src/contacts-typeset.vala"
						i = _tmp3_ + 1;
#line 1231 "contacts-typeset.c"
					}
#line 217 "../src/contacts-typeset.vala"
					_tmp2_ = FALSE;
#line 217 "../src/contacts-typeset.vala"
					if (!(i < G_N_ELEMENTS (CONTACTS_TYPESET_general_data))) {
#line 217 "../src/contacts-typeset.vala"
						break;
#line 1239 "contacts-typeset.c"
					}
#line 218 "../src/contacts-typeset.vala"
					_tmp4_ = contacts_typeset__general;
#line 218 "../src/contacts-typeset.vala"
					_tmp5_ = CONTACTS_TYPESET_general_data[i];
#line 218 "../src/contacts-typeset.vala"
					contacts_typeset_add_vcard_mapping (_tmp4_, &_tmp5_);
#line 1247 "contacts-typeset.c"
				}
			}
		}
#line 219 "../src/contacts-typeset.vala"
		_tmp6_ = contacts_typeset__general;
#line 219 "../src/contacts-typeset.vala"
		contacts_typeset_add_type_other (_tmp6_);
#line 1255 "contacts-typeset.c"
	}
#line 222 "../src/contacts-typeset.vala"
	_tmp7_ = contacts_typeset__general;
#line 222 "../src/contacts-typeset.vala"
	result = _tmp7_;
#line 222 "../src/contacts-typeset.vala"
	return result;
#line 1263 "contacts-typeset.c"
}

ContactsTypeSet*
contacts_typeset_get_email (void)
{
	ContactsTypeSet* result;
	ContactsTypeSet* _tmp0_;
	ContactsTypeSet* _tmp7_;
#line 235 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset__email;
#line 235 "../src/contacts-typeset.vala"
	if (_tmp0_ == NULL) {
#line 1276 "contacts-typeset.c"
		ContactsTypeSet* _tmp1_;
		ContactsTypeSet* _tmp6_;
#line 236 "../src/contacts-typeset.vala"
		_tmp1_ = contacts_typeset_new ("Emails");
#line 236 "../src/contacts-typeset.vala"
		_g_object_unref0 (contacts_typeset__email);
#line 236 "../src/contacts-typeset.vala"
		contacts_typeset__email = _tmp1_;
#line 1285 "contacts-typeset.c"
		{
			gint i = 0;
#line 237 "../src/contacts-typeset.vala"
			i = 0;
#line 1290 "contacts-typeset.c"
			{
				gboolean _tmp2_ = FALSE;
#line 237 "../src/contacts-typeset.vala"
				_tmp2_ = TRUE;
#line 237 "../src/contacts-typeset.vala"
				while (TRUE) {
#line 1297 "contacts-typeset.c"
					ContactsTypeSet* _tmp4_;
					ContactsVcardTypeMapping _tmp5_;
#line 237 "../src/contacts-typeset.vala"
					if (!_tmp2_) {
#line 1302 "contacts-typeset.c"
						gint _tmp3_;
#line 237 "../src/contacts-typeset.vala"
						_tmp3_ = i;
#line 237 "../src/contacts-typeset.vala"
						i = _tmp3_ + 1;
#line 1308 "contacts-typeset.c"
					}
#line 237 "../src/contacts-typeset.vala"
					_tmp2_ = FALSE;
#line 237 "../src/contacts-typeset.vala"
					if (!(i < G_N_ELEMENTS (CONTACTS_TYPESET_email_data))) {
#line 237 "../src/contacts-typeset.vala"
						break;
#line 1316 "contacts-typeset.c"
					}
#line 238 "../src/contacts-typeset.vala"
					_tmp4_ = contacts_typeset__email;
#line 238 "../src/contacts-typeset.vala"
					_tmp5_ = CONTACTS_TYPESET_email_data[i];
#line 238 "../src/contacts-typeset.vala"
					contacts_typeset_add_vcard_mapping (_tmp4_, &_tmp5_);
#line 1324 "contacts-typeset.c"
				}
			}
		}
#line 239 "../src/contacts-typeset.vala"
		_tmp6_ = contacts_typeset__email;
#line 239 "../src/contacts-typeset.vala"
		contacts_typeset_add_type_other (_tmp6_);
#line 1332 "contacts-typeset.c"
	}
#line 242 "../src/contacts-typeset.vala"
	_tmp7_ = contacts_typeset__email;
#line 242 "../src/contacts-typeset.vala"
	result = _tmp7_;
#line 242 "../src/contacts-typeset.vala"
	return result;
#line 1340 "contacts-typeset.c"
}

ContactsTypeSet*
contacts_typeset_get_phone (void)
{
	ContactsTypeSet* result;
	ContactsTypeSet* _tmp0_;
	ContactsTypeSet* _tmp7_;
#line 272 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typeset__phone;
#line 272 "../src/contacts-typeset.vala"
	if (_tmp0_ == NULL) {
#line 1353 "contacts-typeset.c"
		ContactsTypeSet* _tmp1_;
		ContactsTypeSet* _tmp6_;
#line 273 "../src/contacts-typeset.vala"
		_tmp1_ = contacts_typeset_new ("Phones");
#line 273 "../src/contacts-typeset.vala"
		_g_object_unref0 (contacts_typeset__phone);
#line 273 "../src/contacts-typeset.vala"
		contacts_typeset__phone = _tmp1_;
#line 1362 "contacts-typeset.c"
		{
			gint i = 0;
#line 274 "../src/contacts-typeset.vala"
			i = 0;
#line 1367 "contacts-typeset.c"
			{
				gboolean _tmp2_ = FALSE;
#line 274 "../src/contacts-typeset.vala"
				_tmp2_ = TRUE;
#line 274 "../src/contacts-typeset.vala"
				while (TRUE) {
#line 1374 "contacts-typeset.c"
					ContactsTypeSet* _tmp4_;
					ContactsVcardTypeMapping _tmp5_;
#line 274 "../src/contacts-typeset.vala"
					if (!_tmp2_) {
#line 1379 "contacts-typeset.c"
						gint _tmp3_;
#line 274 "../src/contacts-typeset.vala"
						_tmp3_ = i;
#line 274 "../src/contacts-typeset.vala"
						i = _tmp3_ + 1;
#line 1385 "contacts-typeset.c"
					}
#line 274 "../src/contacts-typeset.vala"
					_tmp2_ = FALSE;
#line 274 "../src/contacts-typeset.vala"
					if (!(i < G_N_ELEMENTS (CONTACTS_TYPESET_phone_data))) {
#line 274 "../src/contacts-typeset.vala"
						break;
#line 1393 "contacts-typeset.c"
					}
#line 275 "../src/contacts-typeset.vala"
					_tmp4_ = contacts_typeset__phone;
#line 275 "../src/contacts-typeset.vala"
					_tmp5_ = CONTACTS_TYPESET_phone_data[i];
#line 275 "../src/contacts-typeset.vala"
					contacts_typeset_add_vcard_mapping (_tmp4_, &_tmp5_);
#line 1401 "contacts-typeset.c"
				}
			}
		}
#line 276 "../src/contacts-typeset.vala"
		_tmp6_ = contacts_typeset__phone;
#line 276 "../src/contacts-typeset.vala"
		contacts_typeset_add_type_other (_tmp6_);
#line 1409 "contacts-typeset.c"
	}
#line 279 "../src/contacts-typeset.vala"
	_tmp7_ = contacts_typeset__phone;
#line 279 "../src/contacts-typeset.vala"
	result = _tmp7_;
#line 279 "../src/contacts-typeset.vala"
	return result;
#line 1417 "contacts-typeset.c"
}

static void
contacts_typeset_class_init (ContactsTypeSetClass * klass,
                             gpointer klass_data)
{
#line 27 "../src/contacts-typeset.vala"
	contacts_typeset_parent_class = g_type_class_peek_parent (klass);
#line 27 "../src/contacts-typeset.vala"
	g_type_class_adjust_private_offset (klass, &ContactsTypeSet_private_offset);
#line 27 "../src/contacts-typeset.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_contacts_typeset_get_property;
#line 27 "../src/contacts-typeset.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_contacts_typeset_set_property;
#line 27 "../src/contacts-typeset.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_typeset_finalize;
#line 1434 "contacts-typeset.c"
	/** Returns the category of typeset (mostly used for debugging). */
#line 27 "../src/contacts-typeset.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_TYPESET_CATEGORY_PROPERTY, contacts_typeset_properties[CONTACTS_TYPESET_CATEGORY_PROPERTY] = g_param_spec_string ("category", "category", "category", NULL, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT));
#line 27 "../src/contacts-typeset.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), CONTACTS_TYPESET_STORE_PROPERTY, contacts_typeset_properties[CONTACTS_TYPESET_STORE_PROPERTY] = g_param_spec_object ("store", "store", "store", gtk_list_store_get_type (), G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 1440 "contacts-typeset.c"
}

static void
contacts_typeset_instance_init (ContactsTypeSet * self,
                                gpointer klass)
{
	ContactsTypeDescriptor* _tmp0_;
	GeeArrayList* _tmp1_;
#line 27 "../src/contacts-typeset.vala"
	self->priv = contacts_typeset_get_instance_private (self);
#line 33 "../src/contacts-typeset.vala"
	_tmp0_ = contacts_typedescriptor_new_other ();
#line 33 "../src/contacts-typeset.vala"
	self->priv->other_dummy = _tmp0_;
#line 36 "../src/contacts-typeset.vala"
	_tmp1_ = gee_array_list_new (CONTACTS_TYPE_VCARD_TYPE_MAPPING, (GBoxedCopyFunc) contacts_vcard_type_mapping_dup, (GDestroyNotify) contacts_vcard_type_mapping_free, NULL, NULL, NULL);
#line 36 "../src/contacts-typeset.vala"
	self->priv->vcard_type_mappings = (GeeList*) _tmp1_;
#line 1459 "contacts-typeset.c"
}

static void
contacts_typeset_finalize (GObject * obj)
{
	ContactsTypeSet * self;
#line 27 "../src/contacts-typeset.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_TYPESET, ContactsTypeSet);
#line 30 "../src/contacts-typeset.vala"
	_g_free0 (self->priv->_category);
#line 33 "../src/contacts-typeset.vala"
	_g_object_unref0 (self->priv->other_dummy);
#line 36 "../src/contacts-typeset.vala"
	_g_object_unref0 (self->priv->vcard_type_mappings);
#line 42 "../src/contacts-typeset.vala"
	_g_object_unref0 (self->priv->_store);
#line 27 "../src/contacts-typeset.vala"
	G_OBJECT_CLASS (contacts_typeset_parent_class)->finalize (obj);
#line 1478 "contacts-typeset.c"
}

/**
 * A TypeSet contains all the possible types of a property. For example, a
 * phone number can be both for a personal phone, a work phone or even a fax
 * machine.
 */
static GType
contacts_typeset_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsTypeSetClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_typeset_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsTypeSet), 0, (GInstanceInitFunc) contacts_typeset_instance_init, NULL };
	GType contacts_typeset_type_id;
	contacts_typeset_type_id = g_type_register_static (G_TYPE_OBJECT, "ContactsTypeSet", &g_define_type_info, 0);
	ContactsTypeSet_private_offset = g_type_add_instance_private (contacts_typeset_type_id, sizeof (ContactsTypeSetPrivate));
	return contacts_typeset_type_id;
}

GType
contacts_typeset_get_type (void)
{
	static volatile gsize contacts_typeset_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_typeset_type_id__volatile)) {
		GType contacts_typeset_type_id;
		contacts_typeset_type_id = contacts_typeset_get_type_once ();
		g_once_init_leave (&contacts_typeset_type_id__volatile, contacts_typeset_type_id);
	}
	return contacts_typeset_type_id__volatile;
}

static void
_vala_contacts_typeset_get_property (GObject * object,
                                     guint property_id,
                                     GValue * value,
                                     GParamSpec * pspec)
{
	ContactsTypeSet * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, CONTACTS_TYPE_TYPESET, ContactsTypeSet);
#line 27 "../src/contacts-typeset.vala"
	switch (property_id) {
#line 27 "../src/contacts-typeset.vala"
		case CONTACTS_TYPESET_CATEGORY_PROPERTY:
#line 27 "../src/contacts-typeset.vala"
		g_value_set_string (value, contacts_typeset_get_category (self));
#line 27 "../src/contacts-typeset.vala"
		break;
#line 27 "../src/contacts-typeset.vala"
		case CONTACTS_TYPESET_STORE_PROPERTY:
#line 27 "../src/contacts-typeset.vala"
		g_value_set_object (value, contacts_typeset_get_store (self));
#line 27 "../src/contacts-typeset.vala"
		break;
#line 1530 "contacts-typeset.c"
		default:
#line 27 "../src/contacts-typeset.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 27 "../src/contacts-typeset.vala"
		break;
#line 1536 "contacts-typeset.c"
	}
}

static void
_vala_contacts_typeset_set_property (GObject * object,
                                     guint property_id,
                                     const GValue * value,
                                     GParamSpec * pspec)
{
	ContactsTypeSet * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, CONTACTS_TYPE_TYPESET, ContactsTypeSet);
#line 27 "../src/contacts-typeset.vala"
	switch (property_id) {
#line 27 "../src/contacts-typeset.vala"
		case CONTACTS_TYPESET_CATEGORY_PROPERTY:
#line 27 "../src/contacts-typeset.vala"
		contacts_typeset_set_category (self, g_value_get_string (value));
#line 27 "../src/contacts-typeset.vala"
		break;
#line 27 "../src/contacts-typeset.vala"
		case CONTACTS_TYPESET_STORE_PROPERTY:
#line 27 "../src/contacts-typeset.vala"
		contacts_typeset_set_store (self, g_value_get_object (value));
#line 27 "../src/contacts-typeset.vala"
		break;
#line 1562 "contacts-typeset.c"
		default:
#line 27 "../src/contacts-typeset.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 27 "../src/contacts-typeset.vala"
		break;
#line 1568 "contacts-typeset.c"
	}
}

